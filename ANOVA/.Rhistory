y_box <- array(0,dim = c(T, 2))
#V[1,] <- apply(keeps$v[,1,], 2, mean)
V <- apply(keeps$v, 2:3, mean)
#overwrite J
J <- apply(keeps$J, 2:3, mean)
sim <- 0
mu <- apply(keeps$mu, 2 ,mean)
theta <- apply(keeps$theta,2, mean)
kappa <- 1 - apply(keeps$phi, 2, mean)
for (t in 1:T){
print(t)
set.seed(t + 4922035+ sim)
# delta <- sample(c(0:3),prob=apply(keeps$lambda, 2, mean), 1)
#
# set.seed(15866245 + t + sim)
# if(model == "MVN"){
#   B <- 1
# }else{
#   B <- rexp(1)
# }
# Sigma <- matrix(c(mean(keeps$sigma_c[,1])^2,
#                   mean(keeps$rhoc)*mean(keeps$sigma_c[,1])*mean(keeps$sigma_c[,2]),
#                   mean(keeps$rhoc)*mean(keeps$sigma_c[,1])*mean(keeps$sigma_c[,2]),
#                   mean(keeps$sigma_c[,2]^2)),
#                 nrow=2)
Sigma <- matrix(c(V[t,1],
mean(keeps$rho[,1])*sqrt(prod(V[t,])),
mean(keeps$rho[,3])*mean(keeps$sigma_v[,1])*V[t,1],0,
mean(keeps$rho[,1])*sqrt(prod(V[t,])),V[t,2],0,mean(keeps$rho[,4])*mean(keeps$sigma_v[,2])*V[t,2],
mean(keeps$rho[,3])*mean(keeps$sigma_v[,1])*V[t,1],0,mean(keeps$sigma_v[,1])^2*V[t,1],mean(keeps$rho[,2])*prod(apply(keeps$sigma_v, 2, mean))*sqrt(prod(V[t,])),
0,mean(keeps$rho[,4])*mean(keeps$sigma_v[,2])*V[t,2],mean(keeps$rho[,2])*prod(apply(keeps$sigma_v, 2, mean))*sqrt(prod(V[t,])),mean(keeps$sigma_v[,2])^2*V[t,2]),nrow=4)
Mu <- c(Value[t,] - mu - J[t,],
V[t+1,] - V[t,] - kappa*(theta - V[t,]))
set.seed(463468+t)
temp <- rtmvnorm(n = 1,
mean = c(mu + J[t,],
V[t,] + kappa*(theta - V[t,])),
sigma = Sigma, lower=c(-Inf,-Inf, 0, 0))
# V[t+1,] <- temp[c(3:4)]
y[t,] <- temp[c(1:2)]
y_box[t,] <- (solve(chol(Sigma)) %*% Mu)[1:2,]
if( t+1 <= T){ x[t+1] <- 0 }
}
QQdat = data.frame(Value=Value,
y)
p1 <- ggplot() +
geom_point(aes(x=quantile(QQdat$Value.1,seq(0.01,0.99,0.01)),y=quantile(QQdat$X1,seq(0.01,0.99,0.01)))) +
geom_abline(slope=1,intercept=0) +
#xlim(c(-15,15)) + ylim(c(-15,15)) +
xlab("Actual Quantiles") + ylab("Simulated Quantiles") + theme_bw() + ggtitle(paste0("SV-", model))
# p2 <- ggplot() +
#   geom_point(aes(x=quantile(QQdat$SP,seq(0.01,0.99,0.01)),y=quantile(QQdat$X2,seq(0.01,0.99,0.01)))) +
#   geom_abline(slope=1,intercept=0) +
#   #xlim(c(-15,15)) + ylim(c(-15,15)) +
#   xlab("Actual Quantiles") + ylab("Simulated Quantiles") + theme_bw() + ggtitle("S&P")
# p3 <- grid.arrange(p1,p2, nrow = 1)
return(list(graph = p1 + theme(plot.title = element_text(hjust = 0.5)),
p.vals = c(ks.test(QQdat$Value.1,QQdat$X1)$p.value,
Box.test(y_box[,1],lag=5,type="Ljung-Box")$p.value,
Box.test(y_box[,1],lag=10,type="Ljung-Box")$p.value)))
}
asset_names <- c("ALB","AMC","BB","CHWY",
"CVNA","DG","ENPH","GME",
"HOOD","LEG","MARA","MGM",
"MRNA","NIO","PLTR","RBLX",
"RIOT","RIVN","RKLB","SOFI",
"SQ","TLRY","TSLA","USB")
############################################################
#----SHORT TIME SERIES ONLY---------------------------------
#ALL CRYPTO, MEME STOCKS
############################################################
#load data
keeps <- readRDS(paste0("keeps_","SVMALD" ,"_","MRNA", ".RDS"))
names <- lapply(keeps[c(4,6:17)], domean, total = 10) %>%unlist %>%names
rho_probs <- array(dim = c(length(asset_names),4))
rownames(rho_probs) <- asset_names
colnames(rho_probs) <- c("SV-IND", "SV-LD", "SV-MVN", "SV-MALD")
rho_comp <- array(dim = c(length(asset_names),3))
rownames(rho_comp) <- asset_names
colnames(rho_comp) <- c("SV-LD", "SV-MVN", "SV-MALD")
i = 0
asset = asset_names[1]
i = i + 1
j = 0
for (m in c("SVIND", "SVLD", "SVMVN", "SVMALD")){# "SVMVN", "SVLD",
j = j + 1
keeps <- readRDS(paste0("keeps_",m,"_",asset,".RDS"))
if (m == "SVIND"){
rho_sav <- keeps$rho[,3]
}
# if (j == 1){
#   keeps_medians <- array(dim = c(4, length(names)))
#   keeps_summary <- array(dim = c(4, length(names)))
#   keeps_creds_lower <- array(dim = c(4, length(names)))
#   keeps_creds_upper <- array(dim = c(4, length(names)))
#   keeps_v1 <- array(dim = c(4,dim(keeps$v)[2]))
#   keeps_v2 <- array(dim = c(4,dim(keeps$v)[2]))
#   keeps_j1 <- array(dim = c(4,dim(keeps$J)[2]))
#   keeps_j2 <- array(dim = c(4,dim(keeps$J)[2]))
#
#   rho_probs <- array(dim = c(4,4))
#   model <- rep(NA, 4)
#   colnames(keeps_summary) <- names
# }
# keeps_v1[j,] <- apply(keeps$v[,,1], 2, mean,na.rm=TRUE) #alternative sv
# keeps_v2[j,] <- apply(keeps$v[,,2], 2, mean,na.rm=TRUE) #sp sv
#
# keeps_j1[j,] <- apply(keeps$J[,,1], 2, mean,na.rm=TRUE) #alternative sv
# keeps_j2[j,] <- apply(keeps$J[,,2], 2, mean,na.rm=TRUE) #sp sv
# keeps_medians[j,] <- lapply(keeps[c(4,6:17)], domean, total = 10000) %>%unlist
# keeps_creds_lower[j,] <- lapply(keeps[c(4,6:17)], docreds, q=.025, total = 10000) %>%unlist
# keeps_creds_upper[j,] <- lapply(keeps[c(4,6:17)], docreds, q=.975, total = 10000) %>%unlist
#
# keeps_medians[j,] <- ifelse(grepl("phi",names),1-keeps_medians[j,],keeps_medians[j,])
# tmp <- ifelse(grepl("phi",names),1-keeps_creds_upper[j,],keeps_creds_lower[j,])
# keeps_creds_upper[j,] <- ifelse(grepl("phi",names),1-keeps_creds_lower[j,],keeps_creds_upper[j,])
# keeps_creds_lower[j,] <- tmp
# keeps_v1[j,] <- apply(keeps$v[,,1], 2, mean) #alternative sv
# keeps_v2[j,] <- apply(keeps$v[,,2], 2, mean) #sp sv
# keeps_j1[j,] <- apply(keeps$J[,,1], 2, mean) #alternative sv
# keeps_j2[j,] <- apply(keeps$J[,,2], 2, mean) #sp sv
# model[j] <- m
# keeps_summary[j,] <- paste0(format(round(as.numeric(keeps_medians[j,]),2),nsmall=2)," (",
#                             format(round(as.numeric(keeps_creds_lower[j,]),2),nsmall=2),",",
#                             format(round(as.numeric(keeps_creds_upper[j,]),2),nsmall=2),")")
# resids <- (100*(S$Value[-1] - S$Value[-(T+1)]) - mean(keeps$mu[,1]) - keeps_j1[1,])/sqrt(keeps_v1[j,-(T+1)])
# plot <- get_qq(keeps,m)
# assign(paste0("QQ_",m),plot)
rho_probs[i,j] <- length(which(keeps$rho[,3] > 0))/length(keeps$rho[,3])
if (j > 1){
rho_comp[i,j-1] <- length(which(keeps$rho[,3] > rho_sav))/length(keeps$rho[,3])
# rho_comp[i,j-1] <- ks.test(keeps$rho[,3],rho_sav)$p.value
}
# print(ks.test(resids,"pnorm"))
# model[j] <-m
}
# keeps_summary <- cbind(keeps_summary,rho_probs[,3],rho_probs[,4])
# keeps_summary[keeps_summary == 0] <- "$>0.9999$"
# rownames(keeps_summary) <- gsub("SV","SV-",model)
# colnames(keeps_summary) <- c("$\\lambda_{y1}$","$\\lambda_{y2}$","$\\lambda_{c}$","$\\lambda_0$",
#                              "$\\sigma_{v1}$","$\\sigma_{v2}$","$\\nu_{y1c}$","$\\nu_{y2c}$",
#                              "$\\rho_c$","$\\mu_{y1c}$","$\\mu_{y2c}$","$\\nu_{y1}$","$\\mu_{y1}$",
#                              "$\\nu_{y2}$","$\\mu_{y2}$","$\\kappa_1$","$\\kappa_2$",
#                              "$\\theta_1$","$\\theta_2$","$\\mu_1$","$\\mu_2$",
#                              "$\\rho_y$","$\\rho_v$","$\\rho_1$","$\\rho_2$",
#                              "$P(\\rho_1 > 0 | \\boldsymbol{y})$",
#                              "$P(\\rho_2 < 0 | \\boldsymbol{y})$"
# )
# keeps_summary <- keeps_summary[,c("$\\lambda_{y1}$","$\\lambda_{y2}$","$\\lambda_{c}$","$\\lambda_0$",
#                                   "$\\mu_1$","$\\mu_2$","$\\theta_1$","$\\theta_2$",
#                                   "$\\kappa_1$","$\\kappa_2$","$\\sigma_{v1}$","$\\sigma_{v2}$",
#                                   "$\\rho_y$","$\\rho_v$","$\\rho_1$","$\\rho_2$",
#                                   "$\\mu_{y1c}$","$\\mu_{y2c}$","$\\nu_{y1c}$","$\\nu_{y2c}$",
#                                   "$\\rho_c$","$\\mu_{y1}$","$\\nu_{y1}$","$\\mu_{y2}$",
#                                   "$\\nu_{y2}$",
#                                   "$P(\\rho_1 > 0 | \\boldsymbol{y})$",
#                                   "$P(\\rho_2 < 0 | \\boldsymbol{y})$"
# )]
# keeps_summary[keeps_summary == " 0.00 ( 0.00, 0.00)"] <- "-"
# keeps_summary[keeps_summary == " 5.00 ( 5.00, 5.00)"] <- "-"
#
#
# #TABLE XXX POSTERIOR MEANS OF PARAMETERS------
# t(keeps_summary) %>%
#   xtable() %>%
#   print(sanitize.text.function = function(x){x},
#         type = "latex",
#         include.rownames=TRUE,
#         include.colnames=TRUE,
#         hline.after = c(-1,0,4,16,21,25,27))
# #FIGURE XXX STOCHASTIC VOLATILITY--------
# if(i == "BTC"){
#   sqrt(t(252*keeps_v1)) %>%as.data.frame()%>%
#     rename("SV-IND"=V1,"SV-LD"=V2,"SV-MVN"=V3,"SV-MALD"=V4) %>%
#     mutate(Price = S$`BTC-USD.Close`,
#            Date = S$Date) %>% #change when add more models
#     pivot_longer(-c(Price,Date),names_to="Model",values_to="Volatility") %>%
#     pivot_longer(-c(Date,Model),names_to="series",values_to="value",) %>%
#     ggplot() +
#     geom_line(aes(x = Date, y = value, linetype = Model)) +
#     facet_grid(series~., scales = "free_y") +
#     theme_bw() +
#     annotate("rect",
#              xmin=as.Date("2017-11-06"),
#              xmax=as.Date("2018-01-01"),
#              ymin=-Inf,ymax=Inf,fill="blue",alpha=0.2)+
#     annotate("rect",
#              xmin=as.Date("2018-01-01"),
#              xmax=as.Date("2018-07-01"),
#              ymin=-Inf,ymax=Inf,fill="red",alpha=0.2)+
#     annotate("rect",
#              xmin=as.Date("2020-09-01"),
#              xmax=as.Date("2020-12-31"),
#              ymin=-Inf,ymax=Inf,fill="blue",alpha=0.2)+
#     annotate("rect",
#              xmin=as.Date("2021-05-01"),
#              xmax=as.Date("2021-06-30"),
#              ymin=-Inf,ymax=Inf,fill="red",alpha=0.2)+
#     theme(plot.margin=unit(c(1, 8, 1, 1), 'lines'),
#           legend.position = c(1.15, 0.25),
#           legend.background = element_rect(fill = "white", colour = NA))+
#     scale_colour_grey() +
#     labs(x = "Date", y = "Value")+ theme(text = element_text(size = 20))
#   ggsave("BTC_Vol.pdf", height = 8, width = 11)
#
#   keeps_j1_long <- keeps_j1 %>%as.data.frame()%>%
#     mutate(model = model) %>%
#     melt(id.vars = c("model")) %>%
#     mutate(Date = rep(S$Date[-1], each = 4), #change when add more models
#            series = "BTC")
#
#   keeps_j2_long <- keeps_j2 %>%as.data.frame()%>%
#     mutate(model = model) %>%
#     melt(id.vars = c("model")) %>%
#     mutate(Date = rep(S$Date[-1], each = 4), #change when add more models
#            series = "S&P 500")
#
#
#   rbind(keeps_j1_long,keeps_j2_long) %>%
#     mutate(Model = factor(model, levels = c("SVIND", "SVLD", "SVMVN", "SVMALD"), labels = c("SV-IND", "SV-LD", "SV-MVN", "SV-MALD"))) %>%
#     ggplot() +
#     geom_line(aes(x = Date, y = value)) +
#     facet_grid(series~Model, scales = "free_y") +
#     theme_bw() +
#     scale_colour_grey() +
#     labs(x = "Date", y = "Jump size")+ theme(text = element_text(size = 20))
#   ggsave("jump_sizes.pdf", height = 10, width = 14)
#
# }
#
# keeps_v2_long <- sqrt(t(252*keeps_v2)) %>%as.data.frame()%>%
#   rename("IND"=V1,"LD"=V2,"MVN"=V3,"MALD"=V4) %>%
#   mutate(Price = S$`GSPC.Close`,
#          Date = S$Date) %>% #change when add more models
#   gather("model","Volatility",-c(Price,Date)) %>%
#   gather("series","value",-c(Date,model))
#
# keeps_v1_long %>%
#   mutate(Model = factor(model, levels = c("IND", "LD", "MVN", "MALD"), labels = c("SV-IND", "SV-LD", "SV-MVN", "SV-MALD"))) %>%
#   ggplot() +
#   geom_line(aes(x = Date, y = value, linetype = Model)) +
#   facet_grid(series~., scales = "free_y") +
#   theme_bw() +
#   annotate("rect",
#            xmin=as.Date("1990-01-01"),
#            xmax=as.Date("1991-07-01"),
#            ymin=-Inf,ymax=Inf,fill="blue",alpha=0.2)+
#   annotate("rect",
#            xmin=as.Date("2003-01-01"),
#            xmax=as.Date("2003-07-01"),
#            ymin=-Inf,ymax=Inf,fill="blue",alpha=0.2)+
#   annotate("rect",
#            xmin=as.Date("1998-01-01"),
#            xmax=as.Date("1999-01-01"),
#            ymin=-Inf,ymax=Inf,fill="red",alpha=0.2)+
#   annotate("rect",
#            xmin=as.Date("2001-07-01"),
#            xmax=as.Date("2002-07-01"),
#            ymin=-Inf,ymax=Inf,fill="red",alpha=0.2)+
#   theme(plot.margin=unit(c(1, 8, 1, 1), 'lines'),
#     legend.position = c(1.15, 0.25),
#         legend.background = element_rect(fill = "white", colour = NA))+
#   scale_colour_grey() +
#   labs(x = "Date", y = "Value")+ theme(text = element_text(size = 20))
# ggsave("Oil_Vol.pdf", height = 8, width = 11)
#
# keeps_v2_long %>%
#   mutate(Model = factor(model, levels = c("IND", "LD", "MVN", "MALD"), labels = c("SV-IND", "SV-LD", "SV-MVN", "SV-MALD"))) %>%
#   ggplot() +
#   geom_line(aes(x = Date, y = value, linetype = Model)) +
#   facet_grid(series~., scales = "free_y") +
#   theme_bw() +
#   theme(plot.margin=unit(c(1, 8, 1, 1), 'lines'),
#         legend.position = c(1.15, 0.25),
#         legend.background = element_rect(fill = "white", colour = NA))+
#   scale_colour_grey() +
#   labs(x = "Date", y = "Value")+ theme(text = element_text(size = 20))
# ggsave("SP_Vol_oil.pdf", height = 8, width = 11)
#
# keeps_v1_short <- sqrt(t(252*keeps_v1)) %>%as.data.frame()%>%
#   rename("IND"=V1,"LD"=V2,"MVN"=V3,"MALD"=V4) %>%
#   mutate(Date=S$Date,
#          Series="OIL") %>%
#   gather("Model","Value",-c(Date,Series))
#
# keeps_v2_short <- sqrt(t(252*keeps_v2)) %>%as.data.frame()%>%
#   rename("IND"=V1,"LD"=V2,"MVN"=V3,"MALD"=V4) %>%
#   mutate(Date=S$Date,
#          Series="S&P 500") %>%
#   gather("Model","Value",-c(Date,Series))
#
# S %>%
#   dplyr::select(Date,Value,`GSPC.Close`) %>%
#   rename(OIL = Value,`S&P 500` = `GSPC.Close`) %>%
#   gather("Series","Value",-Date) %>%
#   ggplot() +
#     geom_line(aes(x = Date, y = Value)) +
#     facet_grid(Series~., scales = "free_y")+
#     theme_bw() +
#     scale_colour_grey() +
#     labs(x = "Date", y = "Price")+ theme(text = element_text(size = 20))
#   ggsave("Price_oil_SP.pdf", height = 8, width = 11)
#
# rbind(keeps_v1_short,keeps_v2_short) %>%
#   ggplot() +
#   geom_line(aes(x = Date, y = Value, linetype = Model)) +
#   facet_grid(Series~., scales = "free_y")+
#   theme_bw() +
#   scale_colour_grey() +
#   labs(x = "Date", y = "Annual Volatility")+ theme(text = element_text(size = 20))
# ggsave("Vol_oil_SP.pdf", height = 8, width = 11)
#
#   #FIGURE XXX JUMP SIZES--------
rho_sav
plot(rho_sav)
plot(keeps$rho[,3])
source("C:/Users/mstuart1/OneDrive - Loyola University Chicago/Matt Stuart _ PhD Research/MALD_New/MEME/empirical_results_MEME.R", echo=TRUE)
rho_comp
source("C:/Users/mstuart1/OneDrive - Loyola University Chicago/Matt Stuart _ PhD Research/MALD_New/Crypto/empirical_results_Crypto.R", echo=TRUE)
setwd("C:/Users/mstuart1/OneDrive - Loyola University Chicago/Matt Stuart _ PhD Research/MALD_New/Crypto")
source("C:/Users/mstuart1/OneDrive - Loyola University Chicago/Matt Stuart _ PhD Research/MALD_New/Crypto/empirical_results_Crypto.R", echo=TRUE)
xtable(rho_probs)
min(ADA$Date)
get(asset_names[1])
get(asset_names[1])$Date
get(asset_names[1])$Date %>% min
setwd("C:/Users/mstuart1/OneDrive - Loyola University Chicago/Matt Stuart _ PhD Research/MALD_New/MEME")
source("C:/Users/mstuart1/OneDrive - Loyola University Chicago/Matt Stuart _ PhD Research/MALD_New/MEME/empirical_results_MEME.R", echo=TRUE)
xtable(rho_probs)
source("C:/Users/mstuart1/OneDrive - Loyola University Chicago/Matt Stuart _ PhD Research/MALD_New/MEME/empirical_results_MEME.R", echo=TRUE)
rho_probs
get(asset)$Date %>% min
get(asset)$Date %>% min %>% as.character()
source("C:/Users/mstuart1/OneDrive - Loyola University Chicago/Matt Stuart _ PhD Research/MALD_New/MEME/empirical_results_MEME.R", echo=TRUE)
rho_probs
source("C:/Users/mstuart1/OneDrive - Loyola University Chicago/Matt Stuart _ PhD Research/MALD_New/MEME/empirical_results_MEME.R", echo=TRUE)
rho_probs
xtable(rho_probs)
xtable(rho_comp)
setwd("C:/Users/mstuart1/OneDrive - Loyola University Chicago/Matt Stuart _ PhD Research/MALD_New/Crypto")
source("C:/Users/mstuart1/OneDrive - Loyola University Chicago/Matt Stuart _ PhD Research/MALD_New/Crypto/empirical_results_Crypto.R", echo=TRUE)
xtable(rho_probs)
source("C:/Users/mstuart1/OneDrive - Loyola University Chicago/Matt Stuart _ PhD Research/MALD_New/Crypto/empirical_results_Crypto.R", echo=TRUE)
setwd("C:/Users/mstuart1/OneDrive - Loyola University Chicago/Matt Stuart _ PhD Research/MALD_New/Crypto")
source("C:/Users/mstuart1/OneDrive - Loyola University Chicago/Matt Stuart _ PhD Research/MALD_New/Crypto/empirical_results_Crypto.R", echo=TRUE)
xtable(rho_probs)
xtable(rho_comp)
# Don't forget to set your working directory!
bloodpressure <- read.csv("Data/bloodpressure.csv")
# Syntax for scatter plot in base R is plot(Y ~ X,data.frame)
plot(SBP ~ Age,bloodpressure)
plot(SBP ~ Age,bloodpressure)
# abline adds a straight line through the data, a is the intercept and b is the slop
abline(a = mean(bloodpressure$SBP) + 3*mean(bloodpressure$Age),
b = -3)
n <- 20
sum_x <- 40
sum_y <- 230
sum_x2 <- 100
sum_y2 <- 3500
sum_xy <- 500
xbar <- sum_x/n
ybar <- sum_y/n
num <- sum_xy - n*xbar*ybar
den <- sum_x2 - n*xbar^2
beta1 <- num/den
beta0 <- ybar - beta1*xbar
beta1
beta0
# The function lm performs least squares regression in R using the same syntax we used for the scatterplot
# Let's run a linear regression for systolic blood pressure by age
mod <- lm(SBP ~ Age,bloodpressure)
summary(mod)
98.7147 + 0.9709*50
# Long way
# The function deviance() calculates the sum of squared errors for a linear model
SSE <- deviance(mod)
# The function df.residual() calculates the error degrees of freedom (n-2 in simple linear regression) for a linear model
dfE <- df.residual(mod)
MSE <- SSE/dfE
MSE
# summary(mod) gives you the estimate of the standard deviation (root mean squared error) by the residual standard error
summary(mod)
# summary(mod)$s extract the standard deviation from the summary of the linear model
summary(mod)$s^2
# plot(mod,1) gives a residual plot from a linear model
plot(mod,1)
# plot(mod,2) produces a QQ-plot from a linear model
plot(mod,2)
# Long Way
# We can obtain beta1_hat and its standard error from summary(mod)
summary(mod)
beta1hat <- 0.9709
se <- 0.2102
df <- 28
alpha <- 0.1
crit <- qt(1-alpha/2,df=df)
beta1hat + c(-1,1) * crit * se
# Short Cut
# confint(mod) calculates confidence intervals for a given confidence level for a linear model
confint(mod,level = 0.9)
mod <- lm(SBP ~ Age,bloodpressure)
plot(SBP ~ Age,bloodpressure)
abline(mod)
abline(h=mean(bloodpressure$SBP),lty=2)
summary(mod)
summary(mod)
# t value in the age row is the appropriate test statistic
t <- 0.9709/0.2102
p <- 2*pt(abs(t),28)
t
p
summary(mod)
# t value in the age row is the appropriate test statistic
t <- 0.9709/0.2102
p <- 2*pt(abs(t),28,lower.tail=FALSE)
t
p
drugconc <- read.csv("Data/drugconc.csv")
drugconc <- read.csv("Data/drugconcentration.csv")
drugconc <- read.csv("Data/drugconcentration.csv")
plot(DrugConc ~ Hours,drugconc)
mod_drug <- lm(DrugConc ~ Hours,drugconc)
summary(mod_drug)
# By Hand
x0 <- 55
beta0hat <- summary(mod)$coefficients[1,1]
beta1hat <- summary(mod)$coefficients[2,1]
sigma2hat <- summary(mod)$s^2
xbar <- mean(bloodpressure$Age)
sx2 <- var(bloodpressure$Age)
n <- nrow(bloodpressure) # nrow calculates the number of rows in a matrix or data frame
est <- beta0hat + beta1hat * x0
var_est <- sigma2hat * (1 / n + (x0 - xbar)^2 / ((n-1) * sx2))
alpha <- 0.1
crit <- qt(1 - alpha/2,df=n-2)
est + c(-1,1) * crit * sqrt(var_est)
# By Hand
x0 <- 55
beta0hat <- summary(mod)$coefficients[1,1]
beta1hat <- summary(mod)$coefficients[2,1]
sigma2hat <- summary(mod)$s^2
xbar <- mean(bloodpressure$Age)
sx2 <- var(bloodpressure$Age)
n <- nrow(bloodpressure) # nrow calculates the number of rows in a matrix or data frame
est <- beta0hat + beta1hat * x0
var_est <- sigma2hat * (1 / n + (x0 - xbar)^2 / ((n-1) * sx2))
alpha <- 0.1
crit <- qt(1 - alpha/2,df=n-2)
est + c(-1,1) * crit * sqrt(var_est)
# Using R
# The predict function can calculate predictions from a least squares regression line as well as confidence and prediction intervals
# We need to make a data frame with the explanatory variables to make the predictions we want
newdata <- data.frame(Age = 55)
predict(mod, newdata)
predict(mod, newdata, interval = "confidence", conf.level = 0.9)
predict(mod, newdata, interval = "confidence", level = 0.9)
# By Hand
x0 <- 55
beta0hat <- summary(mod)$coefficients[1,1]
beta1hat <- summary(mod)$coefficients[2,1]
sigma2hat <- summary(mod)$s^2
xbar <- mean(bloodpressure$Age)
sx2 <- var(bloodpressure$Age)
n <- nrow(bloodpressure) # nrow calculates the number of rows in a matrix or data frame
est <- beta0hat + beta1hat * x0
var_est <- sigma2hat * (1 / n + (x0 - xbar)^2 / ((n-1) * sx2))
alpha <- 0.1
crit <- qt(1 - alpha/2,df=n-2)
est + c(-1,1) * crit * sqrt(var_est)
# Using R
# The predict function can calculate predictions from a least squares regression line as well as confidence and prediction intervals
# We need to make a data frame with the explanatory variables to make the predictions we want
newdata <- data.frame(Age = 55)
predict(mod, newdata, interval = "confidence", level = 0.9)
predict(mod,newdata,interval = "prediction",level = 0.9)
dfM <- 1
dfE <- 48
SSM <- 50.83
SST <- 98.48
SSE <- SST - SSM
SSE
dfM <- 1
dfE <- 48
SSM <- 50.83
SST <- 98.48
SSE <- SST - SSM
SSE
MSM <- SSM / dfM
MSE <- SSE / dfE
MSM
MSE
F <- MSM / MSE
F
p <- pf(F,dfM,dfE,lower.tail=FALSE)
p
setwd("C:/Users/mstuart1/OneDrive - Loyola University Chicago/Classes/Fall 2024/STAT 408/Code/ANOVA")
bloodpressure <- read.csv("Data/bloodpressure.csv")
summary(mod)
mod <- lm(SBP ~ Age,bloodpressure)
summary(mod)
anova(mod)
summary(mod)
bloodpressure <- read.csv("Data/bloodpressure.csv")
mod <- lm(SBP ~ Age,bloodpressure)
summary(mod)
anova(mod)
summary(mod)
summary(mod)$r.squared
summary(mod)$r.squared.adj
summary(mod)$adj.r.squared
summary(mod)$r.squared
