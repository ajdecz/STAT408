under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
# Basic scatter plot
plot(health$BMI, health$Life.expectancy, main = "Linear Model Fit", xlab = "BMI", ylab = "Life Expectancy", ylim(0,1000), xlim(0,100))
AIC_model <- lm( #this is my final regression model, I wrote out the model produced from using backward selection and MallowsCP and conducted an ANOVA to see if there's any difference between the two. It is clear that the model using bothways selection and AIC as criterion is more significant regarding the data.
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
# Basic scatter plot
plot(health$BMI, health$Life.expectancy, main = "Linear Model Fit", xlab = "BMI", ylab = "Life Expectancy", ylim(0,1000) xlim(0,100))
AIC_model <- lm( #this is my final regression model, I wrote out the model produced from using backward selection and MallowsCP and conducted an ANOVA to see if there's any difference between the two. It is clear that the model using bothways selection and AIC as criterion is more significant regarding the data.
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
library(lmtest)
plot(best_final_model,1)
best_model <- lm( #this is my final regression model, I wrote out the model produced from using backward selection and MallowsCP and conducted an ANOVA to see if there's any difference between the two. It is clear that the model using bothways selection and AIC as criterion is more significant regarding the data.
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
library(lmtest)
plot(best_model,1)
bptest(best_model)
plot(best_model,2)
ks.test(rstandard(best_model),"pnorm")
?Cars
??Cars
mod <- lm(mpg ~ wt,mtcars)
plot(mod,1)
mod <- lm(mpg ~ wt,mtcars)
plot(mod,1) #horn shaped pattern, violation of homoscedasiticity
library(lmtest)
mod <- lm(mpg ~ wt,mtcars)
plot(mod,1) #horn shaped pattern, violation of homoscedasiticity
library(lmtest)
bptest(mod)
mod <- lm(mpg ~ wt,mtcars)
plot(mod,1) #horn shaped pattern, violation of homoscedasiticity
library(lmtest)
bptest(mod) #saying for now the assumption is violated
plot(mod,1)
mod_ols <- lm(mpg ~ wt, mtcars)
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_wls <- lm(mpg ~ wt, mtcars, wts)
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_wls <- lm(mpg ~ wt, mtcars, weights = wts)
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_wls <- lm(mpg ~ wt, mtcars, weights = wts)
plot(mod_ols,1)
plot(mod_wls,1)
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_wls <- lm(mpg ~ wt, mtcars, weights = wts)
plot(mod_ols,1)
plot(mod_wls,1) + xlim(10,30) + ylim(-4,8)
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_wls <- lm(mpg ~ wt, mtcars, weights = wts)
plot(mod_ols,1)
plot(mod_wls,1)
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_wls <- lm(mpg ~ wt, mtcars, weights = wts)
plot(mod_ols,1)
plot(mod_wls,1)
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_wls <- lm(mpg ~ wt, mtcars, weights = wts)
plot(mod_ols,1)
plot(mod_wls,1) # looks more fitted and normally distributed results
library(lmtest)
bptest(mod_wls)
mod <- lm(mpg ~ wt,mtcars)
plot(mod,1) #horn shaped pattern, violation of homoscedasiticity
library(lmtest)
bptest(mod) #saying for now the assumption is violated
library(leaps)
var_sel <- regsubsets(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health, method='backward', nvmax = 100, really.big = TRUE)
library(tidyverse)
health <- read.csv("Data/lifeexp.csv")
# Scatterplots to see if we need to include a polynomial term
# Adult.Mortality - Linear
ggplot(health, aes(x = Adult.Mortality, y = Life.expectancy)) +
geom_point()
library(tidyverse)
health <- read.csv("Data/lifeexp.csv")
# Scatterplots to see if we need to include a polynomial term
# Adult.Mortality - Linear
ggplot(health, aes(x = Adult.Mortality, y = Life.expectancy)) +
geom_point()
# infant.deaths - Polynomial
ggplot(health, aes(x = infant.deaths, y = Life.expectancy)) +
geom_point()+
xlim(0,75)
# Measles - no relationship
ggplot(health, aes(x = Measles, y = Life.expectancy)) +
geom_point()
# BMI - Linear
ggplot(health, aes(x = BMI, y = Life.expectancy)) +
geom_point()
# under.five.deaths - Polynomial
ggplot(health, aes(x = under.five.deaths, y = Life.expectancy)) +
geom_point()+
xlim(0,100)
# Polio - Polynomial
ggplot(health, aes(x = Polio, y = Life.expectancy)) +
geom_point()
# Diphtheria - Polynomial
ggplot(health, aes(x = Diphtheria, y = Life.expectancy)) +
geom_point()
# HIV.AIDS - Polynomial
ggplot(health, aes(x = HIV.AIDS, y = Life.expectancy)) +
geom_point()
# Income.composition.of.resources - Linear
ggplot(health, aes(x = Income.composition.of.resources, y = Life.expectancy)) +
geom_point()
# Schooling - Linear
ggplot(health, aes(x = Schooling, y = Life.expectancy)) +
geom_point()
mod_max <- lm(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health)
mod_best <- step(mod_max, direction = "both", trace = 0)
summary(mod_best)
library(leaps)
var_sel <- regsubsets(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health, method='backward', nvmax = 100, really.big = TRUE)
which.min(summary(var_sel)$cp)
coef(var_sel,32)
final_model <- lm(
Life.expectancy ~
Status +
BMI +
Diphtheria +
I(infant.deaths^2) +
I(under.five.deaths^2) +
I(Polio^2) +
I(Diphtheria^2) +
I(HIV.AIDS^2) +
Status:Measles +
Status:Diphtheria +
Status:HIV.AIDS +
Adult.Mortality:BMI +
Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria +
Adult.Mortality:Schooling +
infant.deaths:BMI +
infant.deaths:Polio +
infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS +
Measles:BMI +
Measles:under.five.deaths +
Measles:Polio +
Measles:HIV.AIDS +
BMI:Diphtheria +
BMI:HIV.AIDS +
BMI:Schooling +
under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
Polio:Diphtheria +
Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS +
HIV.AIDS:Schooling,
data = your_dataset
)
final_model <- lm(
Life.expectancy ~
Status +
BMI +
Diphtheria +
I(infant.deaths^2) +
I(under.five.deaths^2) +
I(Polio^2) +
I(Diphtheria^2) +
I(HIV.AIDS^2) +
Status:Measles +
Status:Diphtheria +
Status:HIV.AIDS +
Adult.Mortality:BMI +
Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria +
Adult.Mortality:Schooling +
infant.deaths:BMI +
infant.deaths:Polio +
infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS +
Measles:BMI +
Measles:under.five.deaths +
Measles:Polio +
Measles:HIV.AIDS +
BMI:Diphtheria +
BMI:HIV.AIDS +
BMI:Schooling +
under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
Polio:Diphtheria +
Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS +
HIV.AIDS:Schooling,
data = health
)
final_model <- lm(
Life.expectancy ~
Status +
BMI +
Diphtheria +
I(infant.deaths^2) +
I(under.five.deaths^2) +
I(Polio^2) +
I(Diphtheria^2) +
I(HIV.AIDS^2) +
Status:Measles +
Status:Diphtheria +
Status:HIV.AIDS +
Adult.Mortality:BMI +
Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria +
Adult.Mortality:Schooling +
infant.deaths:BMI +
infant.deaths:Polio +
infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS +
Measles:BMI +
Measles:under.five.deaths +
Measles:Polio +
Measles:HIV.AIDS +
BMI:Diphtheria +
BMI:HIV.AIDS +
BMI:Schooling +
under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
Polio:Diphtheria +
Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS +
HIV.AIDS:Schooling,
health
)
library(lmtest)
plot(best_model,1)
library(lmtest)
plot(final_model,1)
bptest(final_model)
plot(final_model,2)
ks.test(rstandard(final_model),"pnorm")
library(tidyverse)
health <- read.csv("Data/lifeexp.csv")
# Scatterplots to see if we need to include a polynomial term
# Adult.Mortality - Linear
ggplot(health, aes(x = Adult.Mortality, y = Life.expectancy)) +
geom_point()
# infant.deaths - Polynomial
ggplot(health, aes(x = infant.deaths, y = Life.expectancy)) +
geom_point()+
xlim(0,75)
# Measles - no relationship
ggplot(health, aes(x = Measles, y = Life.expectancy)) +
geom_point()
# BMI - Linear
ggplot(health, aes(x = BMI, y = Life.expectancy)) +
geom_point()
# under.five.deaths - Polynomial
ggplot(health, aes(x = under.five.deaths, y = Life.expectancy)) +
geom_point()+
xlim(0,100)
# Polio - Polynomial
ggplot(health, aes(x = Polio, y = Life.expectancy)) +
geom_point()
# Diphtheria - Polynomial
ggplot(health, aes(x = Diphtheria, y = Life.expectancy)) +
geom_point()
# HIV.AIDS - Polynomial
ggplot(health, aes(x = HIV.AIDS, y = Life.expectancy)) +
geom_point()
# Income.composition.of.resources - Linear
ggplot(health, aes(x = Income.composition.of.resources, y = Life.expectancy)) +
geom_point()
# Schooling - Linear
ggplot(health, aes(x = Schooling, y = Life.expectancy)) +
geom_point()
mod_max <- lm(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health)
mod_best <- step(mod_max, direction = "both", trace = 0)
summary(mod_best)
library(leaps)
var_sel <- regsubsets(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health, method='backward', nvmax = 100, really.big = TRUE)
which.min(summary(var_sel)$cp)
coef(var_sel,32)
final_model <- lm(
Life.expectancy ~
Status +
BMI +
Diphtheria +
I(infant.deaths^2) +
I(under.five.deaths^2) +
I(Polio^2) +
I(Diphtheria^2) +
I(HIV.AIDS^2) +
Status:Measles +
Status:Diphtheria +
Status:HIV.AIDS +
Adult.Mortality:BMI +
Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria +
Adult.Mortality:Schooling +
infant.deaths:BMI +
infant.deaths:Polio +
infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS +
Measles:BMI +
Measles:under.five.deaths +
Measles:Polio +
Measles:HIV.AIDS +
BMI:Diphtheria +
BMI:HIV.AIDS +
BMI:Schooling +
under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
Polio:Diphtheria +
Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS +
HIV.AIDS:Schooling,
health
)
final_model <- lm(
Life.expectancy ~
Status +
BMI +
Diphtheria +
I(infant.deaths^2) +
I(under.five.deaths^2) +
I(Polio^2) +
I(Diphtheria^2) +
I(HIV.AIDS^2) +
Status:Measles +
Status:Diphtheria +
Status:HIV.AIDS +
Adult.Mortality:BMI +
Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria +
Adult.Mortality:Schooling +
infant.deaths:BMI +
infant.deaths:Polio +
infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS +
Measles:BMI +
Measles:under.five.deaths +
Measles:Polio +
Measles:HIV.AIDS +
BMI:Diphtheria +
BMI:HIV.AIDS +
BMI:Schooling +
under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
Polio:Diphtheria +
Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS +
HIV.AIDS:Schooling,
health
)
library(lmtest)
plot(final_model,1)
bptest(final_model)
plot(final_model,2)
ks.test(rstandard(final_model),"pnorm")
Titanic <- read.csv("Data/Titanic")
getcwd()
getwd()
Titanic <- read.csv("Generalized Linear Models/Data/Titanic")
Titanic <- read.csv("Generalized Linear Models/Data/Titanic")
Titanic <- read.csv("Generalized Linear Models/Data/Titanic.csv")
Titanic <- read.csv("~stat408/Generalized Linear Models/Data/Titanic.csv")
Titanic <- read.csv("~/stat408/Generalized Linear Models/Data/Titanic.csv")
Titanic <- read.csv("~/stat408/Generalized Linear Models/Data/Titanic.csv")
#remove any observations with missing info
Titanic <- na.omit(Titanic)
#Recoding Passenger class to be a factor
Titanic$Pclass <- as.factor(Titanic$Pclass)
mod_glm <- glm(Survived ~ Age + Sex + Pclass,
data = Titanic,
family = binomial())
summary(mod_glm)
newdata <- data.frame(Age=35,Sex='female',Pclass = '1')
predict(mod_glm,newdata) #output is the log odds
newdata <- data.frame(Age=35,Sex='female',Pclass = '1')
predict(mod_glm,newdata) #output is the log odds
#we can put the log odds into the formal exp(x)/(1+exp(x))
# OR
predict.glm(mod_glm,newdata,type = 'response')
library(tidyverse)
library(tidyverse)
airfares <- read.csv(~/stat408/Review and Basics of R/Data/airfares.csv)
library(tidyverse)
airfares <- read.csv(~stat408/Review and Basics of R/Data/airfares.csv)
library(tidyverse)
airfares <- read.csv("~/stat408/Review and Basics of R/Data/airfares.csv")
1 - pnorm(3.5,2,2)
1 - pnorm(3.5,2,2)
pnorm(3.5,2,2,lower.tail = false)
1 - pnorm(3.5,2,2)
pnorm(3.5,2,2,lower.tail = FALSE)
qnorm(0.35,2,2)
pt(2.2,10)
qt(0.8,10)
pf(1.3,6,21)
qf(1-0.4,6,21)
qf(1-0.4,6,21)
qf(0.4,6,21,lower.tail = false)
qf(1-0.4,6,21)
qf(0.4,6,21,lower.tail = FALSE)
# By hand
dist <- airfares$Distance
xbar <- mean(dist)
sx <- sd(dist)
n <- length(dist)
alpha <- 0.05
crit <- qt(1-alpha/2,n-1)
xbar + c(-1,1) * crit * sx / sqrt(n)
# By hand
dist <- airfares$Distance
xbar <- mean(dist)
sx <- sd(dist)
n <- length(dist)
alpha <- 0.05
crit <- qt(1-alpha/2,n-1)
xbar + c(-1,1) * crit * sx / sqrt(n)
#short cut
t.test(dist,conf.level = 1-alpha)
# note that we are using xbar, sx, and n that we defined when calculating the confidence interval
t <- (xbar - 1000)/(sx/sqrt(n))
# two sided t test
p <- 2*pt(abs(t), n-1, lower.tail = FALSE)
t
# note that we are using xbar, sx, and n that we defined when calculating the confidence interval
t <- (xbar - 1000)/(sx/sqrt(n))
# two sided t test
p <- 2*pt(abs(t), n-1, lower.tail = FALSE)
t
p
