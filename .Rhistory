health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, smokeryes, health)
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi + smoker, health)
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, health)
mod <- lm(charges ~ bmi + smoker, health)
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, health)
mod2 <- lm(charges ~ bmi + smoker, health)
r2_mod <- summary(mod)r.squared
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, health)
mod2 <- lm(charges ~ bmi + smoker, health)
r2_mod <- summary(mod)$r.squared
r2_mod2 <- summary(mod)$r.squared
r2_mo2 - r2_mod
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, health)
mod2 <- lm(charges ~ bmi + smoker, health)
r2_mod <- summary(mod)$r.squared
r2_mod2 <- summary(mod2)$r.squared
r2_mod2 - r2_mod
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, health)
mod2 <- lm(charges ~ bmi + smoker, health)
r2_mod <- summary(mod)$r.squared
r2_mod2 <- summary(mod2)$r.squared
r2_mod2 - r2_mod
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, health)
mod2 <- lm(charges ~ bmi + smoker, health)
r2_mod <- summary(mod)$r.squared
r2_mod2 <- summary(mod2)$r.squared
r2_mod2 - r2_mod
r2_mod
r2_mod2
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, health)
mod2 <- lm(charges ~ bmi + smoker, health)
anova(mod,mod2)
library(lmtest)
bptest(mod2)
ks.test(rstandard(mod_2), "pnorm")
library(lmtest)
bptest(mod2)
ks.test(rstandard(mod_2), "pnorm")
library(lmtest)
bptest(mod2)
ks.test(rstandard(mod2), "pnorm")
library(lmtest)
bptest(mod2)
ks.test(rstandard(mod2), "pnorm")
library(lmtest)
bptest(mod2)
plot(mod2,1)
ks.test(rstandard(mod2), "pnorm")
plot(mod2,2)
library(tidyverse)
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ smoker + bmi,health)
mod2 <-  lm(charges ~ smoker * bmi,health)
health %>%
mutate(pred_charges = mod$fitted.values,
pred_charges2 = mod2$fitted.values) %>%
ggplot(aes(x=bmi,y=charges,colour=smoker)) +
geom_point(size=0.5) +
geom_line(aes(y=pred_charges),lty=2) +
geom_line(aes(y=pred_charges2))
mod_confound <- lm(bmi ~ smoker, health)
summary(mod_confound)
# X1:X2 adds an interaction term between X1 and X2
mod_int <- lm(charges~bmi+smoker+bmi:smoker,health)
# X1*X2 this adds the effects of X1 and X2 and an interaction term between X1 and X2
mod_int <- lm(charges ~ bmi*smoker, health)
coef(mod_int)
X1 <- readRDS("~/MASTERS/STAT408/Homework4/Data/X1.rds")
X2 <- readRDS("~/MASTERS/STAT408/Homework4/Data/X2.rds")
y <- readRDS("~/MASTERS/STAT408/Homework4/Data/y.rds")
pwd
dir
path
cd path
X1 <- readRDS(Homework4/X1.rds)
X1 <- readRDS(/Homework4/X1.rds)
X1 <- readRDS(~/Homework4/X1.rds)
X1 <- readRDS(X1.rds)
X1 <- readRDS(/X1.rds)
X1 <- readRDS(X1.rds)
X1 <- readRDS(STAT408/Homework4/X1.rds)
X1 <- readRDS(STAT408/Homework4/X1.rds)
X1 <- readRDS(STAT408/Homework4/X1.rds)
X1 <- readRDS(STAT408/Homework4/X1.rds)
X1 <- readRDS(STAT408/Homework4/X1.rds)
X1 <- readRDS(`STAT408/Homework4/X1.rds)
X2 <- readRDS(~/Homework4/X2.rds)
y <- readRDS(~/Homework4/y.rds)
X1 <- readRDS(Homework4/Data/X1.rds)
X1 <- readRDS(Â¬Homework4/Data/X1.rds)
X1 <- readRDS(Homework4/Data/X1.rds)
X1 <- readRDS(STAT408/Homework4/Data/X1.rds)
X1 <- readRDS(~STAT408/Homework4/Data/X1.rds)
X1 <- readRDS(Homework4/Data/X1.rds)
get(wd)
get(wd)
getwd()
X1 <- readRDS(Homework4/X1.rds)
X1 <- readRDS(Homework4/X1.rds)
X1 <- readRDS(Homework4/X1.rds)
X1 <- readRDS(Homework4/X1.rds)
X1 <- readRDS(Homework4/X1.rds)
X1 <- readRDS(Homework4/X1.rds)
X1 <- readRDS(Homework4/X1.rds)
X1 <- readRDS(Homework4/X1.rds)
list.files(Homework4/Data)
X1 <- readRDS("Homework4/X1.rds")
X1 <- readRDS("Homework4/X1.rds")
y <- readRDS("Homework4/y.rds")
y <- readRDS("Homework4/Data/y.rds")
y <- readRDS("Homework4/Data/y.rds")
y <- readRDS("Data/y.rds")
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y <- readRDS("Data/y.rds")
# load in data
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y <- readRDS("Data/y.rds")
#view them
print(X1)
# load in data
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y <- readRDS("Data/y.rds")
y
# load in data
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y <- readRDS("Data/y.rds")
# load in data
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y <- readRDS("Data/y.rds")
# projection matrix
p1 <- X1 %>%
solve(t(X1) %>% X1) %>% t(X1)
# load in data
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y <- readRDS("Data/y.rds")
# projection matrix
p1 <- X1 %*%
solve(t(X1) %>% X1) %>% t(X1)
# load in data
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y <- readRDS("Data/y.rds")
# projection matrix
p1 <- X1 %*%
solve(t(X1) %*% X1) %*% t(X1)
# fitted values and residuals
yhat1 <- P1 %>% y
# load in data
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y <- readRDS("Data/y.rds")
# projection matrix
p1 <- X1 %*%
solve(t(X1) %*% X1) %*% t(X1)
# fitted values and residuals
yhat1 <- P1 %*% y
# load in data
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y <- readRDS("Data/y.rds")
# projection matrix
p1 <- X1 %*%
solve(t(X1) %*% X1) %*% t(X1)
# fitted values and residuals
yhat1 <- p1 %*% y
resid1 <- y - yhat1
# load in data
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y <- readRDS("Data/y.rds")
# projection matrix
p1 <- X1 %*%
solve(t(X1) %*% X1) %*% t(X1)
# fitted values and residuals
yhat1 <- p1 %*% y
resid1 <- y - yhat1
ssr1 <- t(yhat1) %*% yhat1
sse1 <- (t(y) %*% y) - (t(yhat1)%*%yhat1)
sst1 <- t(y) %*% y
# load in data
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y <- readRDS("Data/y.rds")
# projection matrix
P1 <- X1 %*%
solve(t(X1) %*% X1) %*% t(X1)
# fitted values and residuals
yhat1 <- P1 %*% y
resid1 <- y - yhat1
# sums squares
ssr1 <- t(yhat1) %*% yhat1
sse1 <- (t(y) %*% y) - (t(yhat1)%*%yhat1)
sst1 <- t(y) %*% y
# variance
n <- nrow(X1)
p1 <- ncol(X1)
sigma2hat <- SSE1 / (n - p1)
# load in data
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y <- readRDS("Data/y.rds")
# projection matrix
P1 <- X1 %*%
solve(t(X1) %*% X1) %*% t(X1)
# fitted values and residuals
yhat1 <- P1 %*% y
resid1 <- y - yhat1
# sums squares
ssr1 <- t(yhat1) %*% yhat1
sse1 <- (t(y) %*% y) - (t(yhat1)%*%yhat1)
sst1 <- t(y) %*% y
# variance
n <- nrow(X1)
p1 <- ncol(X1)
sigma2hat <- sse1 / (n - p1)
# estimate
beta_hat <- solve(t(X1) %*% X1) %*% t(X1) %*% y
var_beta <- sigma2hat * solve(t(X1) %*% X1)
# load in data
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y <- readRDS("Data/y.rds")
# projection matrix
P1 <- X1 %*%
solve(t(X1) %*% X1) %*% t(X1)
# fitted values and residuals
yhat1 <- P1 %*% y
resid1 <- y - yhat1
# sums squares
ssr1 <- t(yhat1) %*% yhat1
sse1 <- (t(y) %*% y) - (t(yhat1)%*%yhat1)
sst1 <- t(y) %*% y
# variance
n <- nrow(X1)
p1 <- ncol(X1)
sigma2hat <- sse1 / (n - p1)
# estimate
beta_hat <- solve(t(X1) %*% X1) %*% t(X1) %*% y
var_beta <- sigma2hat %*% solve(t(X1) %*% X1)
# load in data
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y <- readRDS("Data/y.rds")
# projection matrix
P1 <- X1 %*%
solve(t(X1) %*% X1) %*% t(X1)
# fitted values and residuals
yhat1 <- P1 %*% y
resid1 <- y - yhat1
# sums squares
ssr1 <- t(yhat1) %*% yhat1
sse1 <- (t(y) %*% y) - (t(yhat1)%*%yhat1)
sst1 <- t(y) %*% y
# variance
n <- nrow(X1)
p1 <- ncol(X1)
sigma2hat <- sse1 / (n - p1)
# estimate
x1t <- solve(t(X1) %*% X1)
beta_hat <- x1t %*% t(X1) %*% y
var_beta <- sigma2hat * x1t
# load in data
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y <- readRDS("Data/y.rds")
# projection matrix
P1 <- X1 %*%
solve(t(X1) %*% X1) %*% t(X1)
# fitted values and residuals
yhat1 <- P1 %*% y
resid1 <- y - yhat1
# sums squares
ssr1 <- t(yhat1) %*% yhat1
sse1 <- (t(y) %*% y) - (t(yhat1)%*%yhat1)
sst1 <- t(y) %*% y
# variance
n <- nrow(X1)
p1 <- ncol(X1)
sigma2hat <- sse1 / (n - p1)
# estimate
x1t <- solve(t(X1) %*% X1)
beta_hat <- x1t %*% t(X1) %*% y
var_beta <- sigma2hat %*% x1t
# --- Load data ---
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y  <- readRDS("Data/y.rds")
# Ensure matrix
X1 <- as.matrix(X1)
X2 <- as.matrix(X2)
y  <- as.matrix(y)
# --- Dimensions ---
n  <- nrow(X1)
p1 <- ncol(X1)
# --- Projection matrix, fitted, residuals ---
XtX_1    <- t(X1) %*% X1               # p1 x p1
XtX_1inv <- solve(XtX_1)               # p1 x p1
P1       <- X1 %*% XtX_1inv %*% t(X1)  # n x n
yhat1 <- P1 %*% y                      # n x 1
resid1 <- y - yhat1                    # n x 1
# --- Sums of squares ---
SST  <- as.numeric(t(y) %*% y)
SSR1 <- as.numeric(t(yhat1) %*% yhat1)
SSE1 <- as.numeric(t(resid1) %*% resid1)
# --- sigma^2 (scalar!) ---
sigma2_hat_1 <- SSE1 / (n - p1)
# --- beta_hat and Var(beta_hat) ---
beta_hat_1 <- XtX_1inv %*% (t(X1) %*% y)   # p1 x 1
Var_beta_1 <- as.numeric(sigma2_hat_1) * XtX_1inv   # scalar * matrix (use * not %*%)
# --- t-test for slope (assumes col 1 = intercept, col 2 = X1) ---
t_stat <- as.numeric(beta_hat_1[2,1] / sqrt(Var_beta_1[2,2]))
df     <- n - p1
p_val  <- 2 * (1 - pt(abs(t_stat), df))
# --- Load data ---
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y  <- readRDS("Data/y.rds")
# Ensure matrix
X1 <- as.matrix(X1)
X2 <- as.matrix(X2)
y  <- as.matrix(y)
# --- Dimensions ---
n  <- nrow(X1)
p1 <- ncol(X1)
# --- Projection matrix, fitted, residuals ---
XtX_1    <- t(X1) %*% X1               # p1 x p1
XtX_1inv <- solve(XtX_1)               # p1 x p1
P1       <- X1 %*% XtX_1inv %*% t(X1)  # n x n
yhat1 <- P1 %*% y                      # n x 1
resid1 <- y - yhat1                    # n x 1
# --- Sums of squares ---
SST  <- (t(y) %*% y)
SSR1 <- (t(yhat1) %*% yhat1)
SSE1 <- (t(resid1) %*% resid1)
# --- sigma^2 (scalar!) ---
sigma2_hat_1 <- SSE1 / (n - p1)
# --- beta_hat and Var(beta_hat) ---
beta_hat_1 <- XtX_1inv %*% (t(X1) %*% y)   # p1 x 1
Var_beta_1 <- (sigma2_hat_1) * XtX_1inv   # scalar * matrix (use * not %*%)
# --- Load data ---
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y  <- readRDS("Data/y.rds")
# Ensure matrix
X1 <- as.matrix(X1)
X2 <- as.matrix(X2)
y  <- as.matrix(y)
# --- Dimensions ---
n  <- nrow(X1)
p1 <- ncol(X1)
# --- Projection matrix, fitted, residuals ---
XtX_1    <- t(X1) %*% X1               # p1 x p1
XtX_1inv <- solve(XtX_1)               # p1 x p1
P1       <- X1 %*% XtX_1inv %*% t(X1)  # n x n
yhat1 <- P1 %*% y                      # n x 1
resid1 <- y - yhat1                    # n x 1
# --- Sums of squares ---
SST  <- (t(y) %*% y)
SSR1 <- (t(yhat1) %*% yhat1)
SSE1 <- (t(resid1) %*% resid1)
# --- sigma^2 (scalar!) ---
sigma2_hat_1 <- SSE1 / (n - p1)
# --- beta_hat and Var(beta_hat) ---
beta_hat_1 <- XtX_1inv %*% (t(X1) %*% y)   # p1 x 1
Var_beta_1 <- as.numeric(sigma2_hat_1) * XtX_1inv   # scalar * matrix (use * not %*%)
# --- t-test for slope (assumes col 1 = intercept, col 2 = X1) ---
t_stat <- (beta_hat_1[2,1] / sqrt(Var_beta_1[2,2]))
df     <- n - p1
p_val  <- 2 * (1 - pt(abs(t_stat), df))
# --- Load data ---
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y  <- readRDS("Data/y.rds")
# Ensure matrix
X1 <- as.matrix(X1)
X2 <- as.matrix(X2)
y  <- as.matrix(y)
# --- Dimensions ---
n  <- nrow(X1)
p1 <- ncol(X1)
# --- Projection matrix, fitted, residuals ---
XtX_1    <- t(X1) %*% X1               # p1 x p1
XtX_1inv <- solve(XtX_1)               # p1 x p1
P1       <- X1 %*% XtX_1inv %*% t(X1)  # n x n
yhat1 <- P1 %*% y                      # n x 1
resid1 <- y - yhat1                    # n x 1
# --- Sums of squares ---
SST  <- (t(y) %*% y)
SSR1 <- (t(yhat1) %*% yhat1)
SSE1 <- (t(resid1) %*% resid1)
# --- sigma^2 (scalar!) ---
sigma2_hat_1 <- SSE1 / (n - p1)
# --- beta_hat and Var(beta_hat) ---
beta_hat_1 <- XtX_1inv %*% (t(X1) %*% y)   # p1 x 1
Var_beta_1 <- as.numeric(sigma2_hat_1) * XtX_1inv   # scalar * matrix (use * not %*%)
# --- t-test for slope (assumes col 1 = intercept, col 2 = X1) ---
t_stat <- (beta_hat_1[2,1] / sqrt(Var_beta_1[2,2]))
df     <- n - p1
p_val  <- 2 * (1 - pt(abs(t_stat), df))
t_stat
p_val
# --- Load data ---
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y  <- readRDS("Data/y.rds")
# Ensure matrix
X1 <- as.matrix(X1)
X2 <- as.matrix(X2)
y  <- as.matrix(y)
# --- Dimensions ---
n  <- nrow(X1)
p1 <- ncol(X1)
# --- Projection matrix, fitted, residuals ---
XtX_1    <- t(X1) %*% X1               # p1 x p1
XtX_1inv <- solve(XtX_1)               # p1 x p1
P1       <- X1 %*% XtX_1inv %*% t(X1)  # n x n
yhat1 <- P1 %*% y                      # n x 1
resid1 <- y - yhat1                    # n x 1
# --- Sums of squares ---
SST  <- (t(y) %*% y)
SSR1 <- (t(yhat1) %*% yhat1)
SSE1 <- (t(resid1) %*% resid1)
# --- sigma^2 (scalar!) ---
sigma2_hat_1 <- SSE1 / (n - p1)
# --- beta_hat and Var(beta_hat) ---
beta_hat_1 <- XtX_1inv %*% (t(X1) %*% y)   # p1 x 1
Var_beta_1 <- as.numeric(sigma2_hat_1) * XtX_1inv   # scalar * matrix (use * not %*%)
# --- t-test for slope (assumes col 1 = intercept, col 2 = X1) ---
t_stat <- (beta_hat_1[2,1] / sqrt(Var_beta_1[2,2]))
df     <- n - p1
p_val  <- 2 * (1 - pt(abs(t_stat), df))
beta_hat
t_stat
p_val
# --- Load data ---
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y  <- readRDS("Data/y.rds")
# Ensure matrix
X1 <- as.matrix(X1)
X2 <- as.matrix(X2)
y  <- as.matrix(y)
# --- Dimensions ---
n  <- nrow(X1)
p1 <- ncol(X1)
# --- Projection matrix, fitted, residuals ---
XtX_1    <- t(X1) %*% X1               # p1 x p1
XtX_1inv <- solve(XtX_1)               # p1 x p1
P1       <- X1 %*% XtX_1inv %*% t(X1)  # n x n
yhat1 <- P1 %*% y                      # n x 1
resid1 <- y - yhat1                    # n x 1
# --- Sums of squares ---
SST  <- (t(y) %*% y)
SSR1 <- (t(yhat1) %*% yhat1)
SSE1 <- (t(resid1) %*% resid1)
# --- sigma^2 (scalar!) ---
sigma2_hat_1 <- SSE1 / (n - p1)
# --- beta_hat and Var(beta_hat) ---
beta_hat_1 <- XtX_1inv %*% (t(X1) %*% y)   # p1 x 1
Var_beta_1 <- as.numeric(sigma2_hat_1) * XtX_1inv   # scalar * matrix (use * not %*%)
# --- t-test for slope (assumes col 1 = intercept, col 2 = X1) ---
t_stat <- (beta_hat_1[2,1] / sqrt(Var_beta_1[2,2]))
df     <- n - p1
p_val  <- 2 * (1 - pt(abs(t_stat), df))
Var_beta_1
# --- Load data ---
X1 <- readRDS("Data/X1.rds")
X2 <- readRDS("Data/X2.rds")
y  <- readRDS("Data/y.rds")
# Ensure matrix
X1 <- as.matrix(X1)
X2 <- as.matrix(X2)
y  <- as.matrix(y)
# --- Dimensions ---
n  <- nrow(X1)
p1 <- ncol(X1)
# --- Projection matrix, fitted, residuals ---
XtX_1    <- t(X1) %*% X1               # p1 x p1
XtX_1inv <- solve(XtX_1)               # p1 x p1
P1       <- X1 %*% XtX_1inv %*% t(X1)  # n x n
yhat1 <- P1 %*% y                      # n x 1
resid1 <- y - yhat1                    # n x 1
# --- Sums of squares ---
SST  <- (t(y) %*% y)
SSR1 <- (t(yhat1) %*% yhat1)
SSE1 <- (t(resid1) %*% resid1)
# --- sigma^2 (scalar!) ---
sigma2_hat_1 <- SSE1 / (n - p1)
# --- beta_hat and Var(beta_hat) ---
beta_hat_1 <- XtX_1inv %*% (t(X1) %*% y)   # p1 x 1
Var_beta_1 <- as.numeric(sigma2_hat_1) * XtX_1inv   # scalar * matrix (use * not %*%)
# --- t-test for slope (assumes col 1 = intercept, col 2 = X1) ---
t_stat <- (beta_hat_1[2,1] / sqrt(Var_beta_1[2,2]))
df     <- n - p1
p_val  <- 2 * (1 - pt(abs(t_stat), df))
t_stat
p_val
