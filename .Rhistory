plot(mod_best1,2)
library(lmtest)
bptest(mod_best1)
ks.test(rstandard(mod_best1), "pnorm")
# the leaps package contains multiple functions to perform variable selection by multiple different methods.
# specifically, the regsubsets() function
# bad news: does not directly output a linear model
library(leaps)
var_sel <- regsubsets(medv ~ .*. + I(crim^2) + I(lstat^2), Boston, method='seqrep', nvmax = 100, really.big = TRUE, trace = 0)
# the leaps package contains multiple functions to perform variable selection by multiple different methods.
# specifically, the regsubsets() function
# bad news: does not directly output a linear model
library(leaps)
var_sel <- regsubsets(medv ~ .*. + I(crim^2) + I(lstat^2), Boston, method='seqrep', nvmax = 100, really.big = TRUE)
# the leaps package contains multiple functions to perform variable selection by multiple different methods.
# specifically, the regsubsets() function
# bad news: does not directly output a linear model
library(leaps)
var_sel <- regsubsets(medv ~ .*. + I(crim^2) + I(lstat^2), Boston, method='seqrep', nvmax = 100, really.big = TRUE)
var_sel
# the leaps package contains multiple functions to perform variable selection by multiple different methods.
# specifically, the regsubsets() function
# bad news: does not directly output a linear model
library(leaps)
var_sel <- regsubsets(medv ~ .*. + I(crim^2) + I(lstat^2), Boston, method='seqrep', nvmax = 100, really.big = TRUE)
var_sel
# the leaps package contains multiple functions to perform variable selection by multiple different methods.
# specifically, the regsubsets() function
# bad news: does not directly output a linear model
library(leaps)
var_sel <- regsubsets(medv ~ .*. + I(crim^2) + I(lstat^2), Boston, method='seqrep', nvmax = 100, really.big = TRUE)
summary(var_sel)
# the leaps package contains multiple functions to perform variable selection by multiple different methods.
# specifically, the regsubsets() function
# bad news: does not directly output a linear model
library(leaps)
var_sel <- regsubsets(medv ~ .*. + I(crim^2) + I(lstat^2), Boston, method='seqrep', nvmax = 100, really.big = TRUE)
#summary(var_sel)
# summary shows which variables are included when we have only one variable model, 2 variable model, etc
summar(var_sel)$cp
# the leaps package contains multiple functions to perform variable selection by multiple different methods.
# specifically, the regsubsets() function
# bad news: does not directly output a linear model
library(leaps)
var_sel <- regsubsets(medv ~ .*. + I(crim^2) + I(lstat^2), Boston, method='seqrep', nvmax = 100, really.big = TRUE)
#summary(var_sel)
# summary shows which variables are included when we have only one variable model, 2 variable model, etc
summary(var_sel)$cp #mallows cp for the models with the given number of variables
summary(var_sel)$adjr2
# the leaps package contains multiple functions to perform variable selection by multiple different methods.
# specifically, the regsubsets() function
# bad news: does not directly output a linear model
library(leaps)
var_sel <- regsubsets(medv ~ .*. + I(crim^2) + I(lstat^2), Boston, method='seqrep', nvmax = 100, really.big = TRUE)
#summary(var_sel)
# summary shows which variables are included when we have only one variable model, 2 variable model, etc
summary(var_sel)$cp #mallows cp for the models with the given number of variables
summary(var_sel)$adjr2
which.min(summary(var_sel)$cp) #model that minimizes mallows cp
which.max(summary(var_sel)$adjrr2)
# the leaps package contains multiple functions to perform variable selection by multiple different methods.
# specifically, the regsubsets() function
# bad news: does not directly output a linear model
library(leaps)
var_sel <- regsubsets(medv ~ .*. + I(crim^2) + I(lstat^2), Boston, method='seqrep', nvmax = 100, really.big = TRUE)
#summary(var_sel)
# summary shows which variables are included when we have only one variable model, 2 variable model, etc
summary(var_sel)$cp #mallows cp for the models with the given number of variables
summary(var_sel)$adjr2
which.min(summary(var_sel)$cp) #model that minimizes mallows cp
which.max(summary(var_sel)$adjr2)
# the leaps package contains multiple functions to perform variable selection by multiple different methods.
# specifically, the regsubsets() function
# bad news: does not directly output a linear model
library(leaps)
var_sel <- regsubsets(medv ~ .*. + I(crim^2) + I(lstat^2), Boston, method='seqrep', nvmax = 100, really.big = TRUE)
#summary(var_sel)
# summary shows which variables are included when we have only one variable model, 2 variable model, etc
summary(var_sel)$cp #mallows cp for the models with the given number of variables
summary(var_sel)$adjr2
which.min(summary(var_sel)$cp) #model that minimizes mallows cp
which.max(summary(var_sel)$adjr2)
coef(var_sel,47)
# the leaps package contains multiple functions to perform variable selection by multiple different methods.
# specifically, the regsubsets() function
# bad news: does not directly output a linear model
library(leaps)
var_sel <- regsubsets(medv ~ .*. + I(crim^2) + I(lstat^2), Boston, method='seqrep', nvmax = 100, really.big = TRUE)
#summary(var_sel)
# summary shows which variables are included when we have only one variable model, 2 variable model, etc
summary(var_sel)$cp #mallows cp for the models with the given number of variables
summary(var_sel)$adjr2
which.min(summary(var_sel)$cp) #model that minimizes mallows cp
which.max(summary(var_sel)$adjr2)
coef(var_sel,47)
coef(var_sel, 53)
library(tidyverse)
health <- read.csv("Data/lifeexp.csv")
# Scatterplots to see if we need to include a polynomial term
# Adult.Mortality - Linear
ggplot(health, aes(x = Adult.Mortality, y = Life.expectancy)) +
geom_point()
library(tidyverse)
health <- read.csv("Data/lifeexp.csv")
# Scatterplots to see if we need to include a polynomial term
# Adult.Mortality - Linear
ggplot(health, aes(x = Adult.Mortality, y = Life.expectancy)) +
geom_point()
# infant.deaths - Polynomial
ggplot(health, aes(x = infant.deaths, y = Life.expectancy)) +
geom_point()+
xlim(0,75)
# Measles - no relationship
ggplot(health, aes(x = Measles, y = Life.expectancy)) +
geom_point()
# BMI - Linear
ggplot(health, aes(x = BMI, y = Life.expectancy)) +
geom_point()
# under.five.deaths - Polynomial
ggplot(health, aes(x = under.five.deaths, y = Life.expectancy)) +
geom_point()+
xlim(0,100)
# Polio - Polynomial
ggplot(health, aes(x = Polio, y = Life.expectancy)) +
geom_point()
# Diphtheria - Polynomial
ggplot(health, aes(x = Diphtheria, y = Life.expectancy)) +
geom_point()
# HIV.AIDS - Polynomial
ggplot(health, aes(x = HIV.AIDS, y = Life.expectancy)) +
geom_point()
# Income.composition.of.resources - Linear
ggplot(health, aes(x = Income.composition.of.resources, y = Life.expectancy)) +
geom_point()
# Schooling - Linear
ggplot(health, aes(x = Schooling, y = Life.expectancy)) +
geom_point()
mod_max <- lm(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health)
mod_best <- step(mod_max, direction = "both", trace = 0)
summary(mod_best)
AIC_model <- lm( #this is my final regression model, I wrote out the model produced from using backward selection and MallowsCP and conducted an ANOVA to see if there's any difference between the two. It is clear that the model using bothways selection and AIC as criterion is more significant regarding the data.
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
AIC_model <- lm( #this is my final regression model, I wrote out the model produced from using backward selection and MallowsCP and conducted an ANOVA to see if there's any difference between the two. It is clear that the model using bothways selection and AIC as criterion is more significant regarding the data.
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
plot(AIC_model, 2)
AIC_model <- lm( #this is my final regression model, I wrote out the model produced from using backward selection and MallowsCP and conducted an ANOVA to see if there's any difference between the two. It is clear that the model using bothways selection and AIC as criterion is more significant regarding the data.
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
plot(AIC_model, 1)
AIC_model <- lm( #this is my final regression model, I wrote out the model produced from using backward selection and MallowsCP and conducted an ANOVA to see if there's any difference between the two. It is clear that the model using bothways selection and AIC as criterion is more significant regarding the data.
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
plot(AIC_model, 3)
AIC_model <- lm( #this is my final regression model, I wrote out the model produced from using backward selection and MallowsCP and conducted an ANOVA to see if there's any difference between the two. It is clear that the model using bothways selection and AIC as criterion is more significant regarding the data.
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
plot(AIC_model, 4)
AIC_model <- lm( #this is my final regression model, I wrote out the model produced from using backward selection and MallowsCP and conducted an ANOVA to see if there's any difference between the two. It is clear that the model using bothways selection and AIC as criterion is more significant regarding the data.
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
plot(AIC_model, 5)
AIC_model <- lm( #this is my final regression model, I wrote out the model produced from using backward selection and MallowsCP and conducted an ANOVA to see if there's any difference between the two. It is clear that the model using bothways selection and AIC as criterion is more significant regarding the data.
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
plot(AIC_model, 4)
AIC_model <- lm( #this is my final regression model, I wrote out the model produced from using backward selection and MallowsCP and conducted an ANOVA to see if there's any difference between the two. It is clear that the model using bothways selection and AIC as criterion is more significant regarding the data.
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
# Basic scatter plot
plot(health$BMI, health$Life.expectancy, main = "Linear Model Fit", xlab = "BMI", ylab = "Life Expectancy")
abline(AIC_model, col = "cyan", lwd = 2)
AIC_model <- lm( #this is my final regression model, I wrote out the model produced from using backward selection and MallowsCP and conducted an ANOVA to see if there's any difference between the two. It is clear that the model using bothways selection and AIC as criterion is more significant regarding the data.
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
# Basic scatter plot
plot(health$BMI, health$Life.expectancy, main = "Linear Model Fit", xlab = "BMI", ylab = "Life Expectancy", ylim(0,1000), xlim(0,100))
AIC_model <- lm( #this is my final regression model, I wrote out the model produced from using backward selection and MallowsCP and conducted an ANOVA to see if there's any difference between the two. It is clear that the model using bothways selection and AIC as criterion is more significant regarding the data.
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
# Basic scatter plot
plot(health$BMI, health$Life.expectancy, main = "Linear Model Fit", xlab = "BMI", ylab = "Life Expectancy", ylim(0,1000) xlim(0,100))
AIC_model <- lm( #this is my final regression model, I wrote out the model produced from using backward selection and MallowsCP and conducted an ANOVA to see if there's any difference between the two. It is clear that the model using bothways selection and AIC as criterion is more significant regarding the data.
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
library(lmtest)
plot(best_final_model,1)
best_model <- lm( #this is my final regression model, I wrote out the model produced from using backward selection and MallowsCP and conducted an ANOVA to see if there's any difference between the two. It is clear that the model using bothways selection and AIC as criterion is more significant regarding the data.
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
library(lmtest)
plot(best_model,1)
bptest(best_model)
plot(best_model,2)
ks.test(rstandard(best_model),"pnorm")
?Cars
??Cars
mod <- lm(mpg ~ wt,mtcars)
plot(mod,1)
mod <- lm(mpg ~ wt,mtcars)
plot(mod,1) #horn shaped pattern, violation of homoscedasiticity
library(lmtest)
mod <- lm(mpg ~ wt,mtcars)
plot(mod,1) #horn shaped pattern, violation of homoscedasiticity
library(lmtest)
bptest(mod)
mod <- lm(mpg ~ wt,mtcars)
plot(mod,1) #horn shaped pattern, violation of homoscedasiticity
library(lmtest)
bptest(mod) #saying for now the assumption is violated
plot(mod,1)
mod_ols <- lm(mpg ~ wt, mtcars)
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_wls <- lm(mpg ~ wt, mtcars, wts)
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_wls <- lm(mpg ~ wt, mtcars, weights = wts)
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_wls <- lm(mpg ~ wt, mtcars, weights = wts)
plot(mod_ols,1)
plot(mod_wls,1)
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_wls <- lm(mpg ~ wt, mtcars, weights = wts)
plot(mod_ols,1)
plot(mod_wls,1) + xlim(10,30) + ylim(-4,8)
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_wls <- lm(mpg ~ wt, mtcars, weights = wts)
plot(mod_ols,1)
plot(mod_wls,1)
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_wls <- lm(mpg ~ wt, mtcars, weights = wts)
plot(mod_ols,1)
plot(mod_wls,1)
mod_ols <- lm(mpg ~ wt, mtcars) #ordinary least squares regression
wts <- 1/fitted(mod_ols)^2 #because horn is increasing
# fitted(mod_ols) provides the fitted values
mod_wls <- lm(mpg ~ wt, mtcars, weights = wts)
plot(mod_ols,1)
plot(mod_wls,1) # looks more fitted and normally distributed results
library(lmtest)
bptest(mod_wls)
mod <- lm(mpg ~ wt,mtcars)
plot(mod,1) #horn shaped pattern, violation of homoscedasiticity
library(lmtest)
bptest(mod) #saying for now the assumption is violated
