library(tidyverse)
ggplot::mpt
ggplot(data = mpg)
ggplot(data = mpg) + geom_point = aes(x = display, y = hwy))
ggplot(data = mpg) + geom_point(mapping = aes(x = display, y = hwy))
run
ggplot2::ggplot()
:
ggplot2:mpt
ggplot2:mpg
q()
q()
git
length(50
5
length(5)
length(1)
length(4)
bloodpressure <- read.csv("/Data/bloodpressure.csv")
bloodpressure <- read.csv("/Data/bloodpressure.csv")
bloodpressure <- read.csv("~/Data/bloodpressure.csv")
bloodpressure <- read_csv("Influential Observations/Data/bloodpressure.csv")
bloodpressure <- read.csv("Influential Observations/Data/bloodpressure.csv")
bloodpressure <- read.csv("Influential_Observations/Data/bloodpressure.csv")
bloodpressure <- read.csv("Influential_Observations/Data/bloodpressure.csv")
library(readr)
bloodpressure <- read_csv("Influential Observations/Data/bloodpressure.csv")
View(bloodpressure)
bloodpressure <- read.csv("Influential_Observations/Data/bloodpressure.csv")
library(readr)
bloodpressure <- read_csv("Influential Observations/Data/bloodpressure.csv")
library(readr)
bloodpressure <- read_csv("/Data/bloodpressure.csv")
library(readr)
bloodpressure <- read_csv("~/Data/bloodpressure.csv")
library(readr)
bloodpressure <- read_csv("Influential Observations/Data/bloodpressure.csv")
View(bloodpressure)
library(readr)
plot(SBP ~ Age, bloodpressure)
library(readr)
bloodpressure <- read.csv("/Data/bloodpressure.csv")
library(readr)
bloodpressure <- read.csv("~/Data/bloodpressure.csv")
library(readr)
bloodpressure <- read.csv("~/Data/bloodpressure.csv")
library(readr)
bloodpressure <- read_csv("Influential Observations/Data/bloodpressure.csv")
library(readr)
bloodpressure <- read_csv("/bloodpressure.csv")
library(readr)
bloodpressure <- read_csv("Data/bloodpressure.csv")
plot(SBP ~ Age, bloodpressure)
# note the potential influential observation is the 2nd in the dataset.
mod <- lm(SBP ~ Age, bloodpressure)
hatvalues(mod)
# note the potential influential observation is the 2nd in the dataset.
mod <- lm(SBP ~ Age, bloodpressure)
hatvalues(mod) #extracts the hat values based off the explanatory variables
#fitted extracts the fitted values from a linear model
#rstudent extracts the studentized residuals from a linear model
plot(fitted(mod),rstudent(mod))
#fitted extracts the fitted values from a linear model
#rstudent extracts the studentized residuals from a linear model
plot(fitted(mod),rstudent(mod))
summary(fitted(mod))
#fitted extracts the fitted values from a linear model
#rstudent extracts the studentized residuals from a linear model
plot(fitted(mod),rstudent(mod))
summary(rstudent(mod))
#fitted extracts the fitted values from a linear model
#rstudent extracts the studentized residuals from a linear model
plot(fitted(mod),rstudent(mod))
# start with the highest studentized residual
rstud <- rstudent(mod)
id <- which.max(rstud)
# start with the highest studentized residual
rstud <- rstudent(mod)
id <- which.max(rstud)
id
# start with the highest studentized residual
rstud <- rstudent(mod)
id <- which.max(abs(rstud))
id
# start with the highest studentized residual
rstud <- rstudent(mod)
id <- which.max(abs(rstud))
n <- nrow(bloodpressure)
k <- 2
alpha <- 0.01
crit <- qt(1-alpha/2,n-1-k)
# start with the highest studentized residual
rstud <- rstudent(mod)
id <- which.max(abs(rstud))
n <- nrow(bloodpressure)
k <- 2
alpha <- 0.01
crit <- qt(1-alpha/2,n-1-k)
crit
# start with the highest studentized residual
rstud <- rstudent(mod)
id <- which.max(abs(rstud))
n <- nrow(bloodpressure)
k <- 2
alpha <- 0.01
crit <- qt(1-alpha/2,n-1-k)
abs(rstud)[id]
# start with the highest studentized residual
rstud <- rstudent(mod)
id <- which.max(abs(rstud))
n <- nrow(bloodpressure)
k <- 2
alpha <- 0.01
crit <- qt(1-alpha/2,n-1-k)
abs(rstud)[id] > crit
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Age, bloodpressure[-2])
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ age, bloodpressure[-2])
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Age, bloodpressure[-2])
# note the potential influential observation is the 2nd in the dataset.
mod <- lm(SBP ~ Age, bloodpressure)
hatvalues(mod) #extracts the leverage values based off the explanatory variables
#higher leverage is a further distance
library(readr)
bloodpressure <- read_csv("Data/bloodpressure.csv")
plot(SBP ~ Age, bloodpressure)
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Adge, bloodpressure[-2])
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Adge, bloodpressure[-2])
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Age, bloodpressure[-2])
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Age, bloodpressure[-2])
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Age, bloodpressure[-2])
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Age, bloodpressure[-2])
# note the potential influential observation is the 2nd in the dataset.
mod <- lm(SBP ~ Age, bloodpressure)
hatvalues(mod) #extracts the leverage values based off the explanatory variables
#higher leverage is a further distance
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Age, bloodpressure[-2])
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Age, bloodpressure[-2])
# note the potential influential observation is the 2nd in the dataset.
mod <- lm(SBP ~ Age, bloodpressure)
hatvalues(mod) #extracts the leverage values based off the explanatory variables
#higher leverage is a further distance
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Age, bloodpressure[-2,])
summary(mod)
summary(mod2)
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Age, bloodpressure[-2,])
summary(mod)
summary(mod_2)
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Age, bloodpressure[-2,])
summary(mod)
summary(mod_2)
plot(SBP ~ Age, bloodpressure)
abline(mod, colour = "red")
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Age, bloodpressure[-2,])
summary(mod)
summary(mod_2)
plot(SBP ~ Age, bloodpressure)
abline(mod)
abline(mod_2, lty=2
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Age, bloodpressure[-2,])
summary(mod)
summary(mod_2)
plot(SBP ~ Age, bloodpressure)
abline(mod)
abline(mod_2, lty=2)
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Age, bloodpressure[-2,])
summary(mod)
summary(mod_2)
plot(SBP ~ Age, bloodpressure)
abline(mod)
abline(mod_2, lty=2)
# bloodpressure [- 2] removes the second row and keeps all columns
mod_2 <- lm(SBP ~ Age, bloodpressure[-2,])
summary(mod)
summary(mod_2)
plot(SBP ~ Age, bloodpressure)
abline(mod)
abline(mod_2, lty=2)
#lets look at a studentized residual plot
plot(fitted(mod_2), rstudent(mod_2))
for i in range 1:5{
for i in range 1:5{
for range 1:5{
for i in range 1:5{
for i in range(5){
for range(5){
for (i in range(1:5)){
i
}
for (i in range(1:5)){
print(i)
}
for (i in range(1,5)){
print(i)
}
for (i in range(5)){
print(i)
}
for (i in range(1,5)){
print(i)
}
for (i in range(1,5)){
print(i)
}
for (i in range(1-5)){
print(i)
}
for (i in range(5)){
print(i)
}
for (i in (1:5)){
print(i)
}
#
plot(mod,4)
func <- function readme(x){
# plot(mod,4) plots each point by its cooks distance
plot(mod,4)
# lets compare the cooks distane for observation 2 to the 4/(n-k-1) cutoff
cooks.distance(mod)[2]
# plot(mod,4) plots each point by its cooks distance
plot(mod,4)
# lets compare the cooks distane for observation 2 to the 4/(n-k-1) cutoff
cooks.distance(mod)[2]/(n-k-1)
# plot(mod,4) plots each point by its cooks distance
plot(mod,4)
# lets compare the cooks distane for observation 2 to the 4/(n-k-1) cutoff
cooks.distance(mod)[-2,]/(n-k-1)
# plot(mod,4) plots each point by its cooks distance
plot(mod,4)
# lets compare the cooks distane for observation 2 to the 4/(n-k-1) cutoff
cooks.distance(mod)[-2]/(n-k-1)
# plot(mod,4) plots each point by its cooks distance
plot(mod,4)
# lets compare the cooks distane for observation 2 to the 4/(n-k-1) cutoff
cooks.distance(mod)[2]/(n-k-1)
# plot(mod,4) plots each point by its cooks distance
plot(mod,4)
# lets compare the cooks distane for observation 2 to the 4/(n-k-1) cutoff
cooks.distance(mod)[2] > 4/(n-k-1)
# Need library(regclass) to run the VIF function
library(regclass)
# Need library(regclass) to run the VIF function
library(regclass)
# Need library(regclass) to run the VIF function
import library(regclass)
# Need library(regclass) to run the VIF function
install.packages(regclass)
# Need library(regclass) to run the VIF function
install.packages("regclass")
# Need library(regclass) to run the VIF function
library(regclass)
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ ., health)
VIF(mod)
ssm1 <- 2469.18
ssm2 <- 3647.83
ssm3 <- 4348.22
#find additional ss
ss_x2_given_x1 <- ssm2 - ssm1
ss_x3_given_x1x2 <- ssm3 - ssm2
ss_x2_given_x1
ss_x3_given_x1x2
total_additional_ssm <- ss_x2_given_x1 + ss_x3_given_x1x2
ssm1 <- 2469.18
ssm2 <- 3647.83
ssm3 <- 4348.22
#find additional ss
ss_x2_given_x1 <- ssm2 - ssm1
ss_x3_given_x1x2 <- ssm3 - ssm2
ss_x2_given_x1
ss_x3_given_x1x2
total_additional_ssm <- ss_x2_given_x1 + ss_x3_given_x1x2
total_additional_ssm
health <- read.csv("Data\insurance.csv")
health <- read_csv("Data\insurance.csv")
health <- read_csv("Data/insurance.csv")
health <- read.csv("Data/insurance.csv")
health <- read.csv("Data/insurance.csv")
view(health)
health <- read.csv("Data/insurance.csv")
view(insurance)
library(readr)
insurance <- read_csv("Confounding and Interactions/Data/insurance.csv")
View(insurance)
health <- read.csv("Data/insurance.csv")
view(insurance)
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, smoker, health)
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, smokeryes, health)
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi + smoker, health)
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, health)
mod <- lm(charges ~ bmi + smoker, health)
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, health)
mod2 <- lm(charges ~ bmi + smoker, health)
r2_mod <- summary(mod)r.squared
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, health)
mod2 <- lm(charges ~ bmi + smoker, health)
r2_mod <- summary(mod)$r.squared
r2_mod2 <- summary(mod)$r.squared
r2_mo2 - r2_mod
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, health)
mod2 <- lm(charges ~ bmi + smoker, health)
r2_mod <- summary(mod)$r.squared
r2_mod2 <- summary(mod2)$r.squared
r2_mod2 - r2_mod
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, health)
mod2 <- lm(charges ~ bmi + smoker, health)
r2_mod <- summary(mod)$r.squared
r2_mod2 <- summary(mod2)$r.squared
r2_mod2 - r2_mod
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, health)
mod2 <- lm(charges ~ bmi + smoker, health)
r2_mod <- summary(mod)$r.squared
r2_mod2 <- summary(mod2)$r.squared
r2_mod2 - r2_mod
r2_mod
r2_mod2
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ bmi, health)
mod2 <- lm(charges ~ bmi + smoker, health)
anova(mod,mod2)
library(lmtest)
bptest(mod2)
ks.test(rstandard(mod_2), "pnorm")
library(lmtest)
bptest(mod2)
ks.test(rstandard(mod_2), "pnorm")
library(lmtest)
bptest(mod2)
ks.test(rstandard(mod2), "pnorm")
library(lmtest)
bptest(mod2)
ks.test(rstandard(mod2), "pnorm")
library(lmtest)
bptest(mod2)
plot(mod2,1)
ks.test(rstandard(mod2), "pnorm")
plot(mod2,2)
library(tidyverse)
health <- read.csv("Data/insurance.csv")
mod <- lm(charges ~ smoker + bmi,health)
mod2 <-  lm(charges ~ smoker * bmi,health)
health %>%
mutate(pred_charges = mod$fitted.values,
pred_charges2 = mod2$fitted.values) %>%
ggplot(aes(x=bmi,y=charges,colour=smoker)) +
geom_point(size=0.5) +
geom_line(aes(y=pred_charges),lty=2) +
geom_line(aes(y=pred_charges2))
mod_confound <- lm(bmi ~ smoker, health)
summary(mod_confound)
# X1:X2 adds an interaction term between X1 and X2
mod_int <- lm(charges~bmi+smoker+bmi:smoker,health)
# X1*X2 this adds the effects of X1 and X2 and an interaction term between X1 and X2
mod_int <- lm(charges ~ bmi*smoker, health)
coef(mod_int)
