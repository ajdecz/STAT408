R2X2
n  <- nrow(X1)
pR <- ncol(X1)
pF <- ncol(X2)
q  <- pF - pR
I  <- diag(n)
PR <- X1 %*% solve(t(X1) %*% X1) %*% t(X1)
PF <- X2 %*% solve(t(X2) %*% X2) %*% t(X2)
SSE_R <- as.numeric(t(y) %*% (I - PR) %*% y)
SSE_F <- as.numeric(t(y) %*% (I - PF) %*% y)
num <- (SSE_R - SSE_F) / q
den <- SSE_F / (n - pF)
f   <- num / den
p <- 1 - pf(f, q, n - pF)
f
p
#check to make sure
modred <- lm(y ~ X1)
modfull <- lm(y ~ X2)
anova(modred, modfull)
# yup we good
n  <- nrow(X1)
pR <- ncol(X1)
pF <- ncol(X2)
q  <- pF - pR
I  <- diag(n)
PR <- X1 %*% solve(t(X1) %*% X1) %*% t(X1)
PF <- X2 %*% solve(t(X2) %*% X2) %*% t(X2)
SSE_R <- as.numeric(t(y) %*% (I - PR) %*% y)
SSE_F <- as.numeric(t(y) %*% (I - PF) %*% y)
num <- (SSE_R - SSE_F) / q
den <- SSE_F / (n - pF)
f   <- num / den
p <- 1 - pf(f, q, n - pF)
f
p
#check to make sure
modred <- lm(y ~ X1)
modfull <- lm(y ~ X2)
anova(modred, modfull)
# yup we good
# From class convo it is clear you wanted linear but I did rstud() method first
# initial observation
plot(modfull,1) #modfull is y ~ XZ (above)
# obs 11 is an influential observation, 73
rstud <- rstudent(modfull)
id1 <- which.max(abs(rstud))
n <- nrow(X2)
k <- 4
alpha <- 0.01
crit <- qt(1-alpha/2,n-k-1)
(abs(rstud)[id1] > crit)
# observation 73 is our next influential observation
modfull2 <- lm(y[-11,] ~ X2[-11, -1])
rstud2 <- rstudent(modfull2)
id2 <- which.max(abs(rstud2))
abs(rstud2)[id2] > crit
# next one 42 is not an influential observation
infl_obs <- c(11,73)
modfull3 <- lm(y[-infl_obs,] ~ X2[-infl_obs, -1])
rstud3 <- rstudent(modfull3)
id3 <- which.max(abs(rstud3))
abs(rstud3)[id3] > crit
# LINEAR
# first test, 11 is influential
hat_mat <- X2 %*% solve(t(X2) %*% X2) %*% t(X2)
yhatx2 <- X2 %*% BX2
errorest <- y - yhatx2
lev <- diag(hat_mat)
MSEX2 <- SSEX2 / (nrow(X2) - k)
stud_resid <- errorest / sqrt(as.numeric(MSEX2)) * sqrt(1 - lev)
id4 <- which.max(abs(stud_resid))
id4
abs(stud_resid)[id4] > crit
# 11 is true
#second test, 73 is influential
X2_rm11 <- X2[-11,]
hat_mat <- X2_rm11 %*% solve(t(X2_rm11) %*% X2_rm11) %*% t(X2_rm11)
yhatx2 <- X2_rm11 %*% BX2
errorest <- y[-11,] - yhatx2
lev <- diag(hat_mat)
MSEX2 <- SSEX2 / (nrow(X2_rm11) - k)
stud_resid <- errorest / sqrt(as.numeric(MSEX2)) * sqrt(1 - lev)
id5 <- which.max(abs(stud_resid))
id5
abs(stud_resid)[id5] > crit
#third test
inf <- c(11,73)
X2_rm_inf <- X2[-inf,]
hat_mat <- X2_rm_inf %*% solve(t(X2_rm_inf) %*% X2_rm_inf) %*% t(X2_rm_inf)
yhatx2 <- X2_rm_inf %*% BX2
errorest <- y[-inf] - yhatx2
lev <- diag(hat_mat)
MSEX2 <- SSEX2 / (nrow(X2_rm_inf) - k)
stud_resid <- errorest / sqrt(as.numeric(MSEX2)) * sqrt(1 - lev)
id6 <- which.max(abs(stud_resid))
id6
abs(stud_resid)[id6] > crit
# From class convo it is clear you wanted linear but I did rstud() method first
# initial observation
plot(modfull,1) #modfull is y ~ XZ (above)
# obs 11 is an influential observation, 73
rstud <- rstudent(modfull)
id1 <- which.max(abs(rstud))
n <- nrow(X2)
k <- 4
alpha <- 0.01
crit <- qt(1-alpha/2,n-k-1)
(abs(rstud)[id1] > crit)
# observation 73 is our next influential observation
modfull2 <- lm(y[-11,] ~ X2[-11, -1])
rstud2 <- rstudent(modfull2)
id2 <- which.max(abs(rstud2))
abs(rstud2)[id2] > crit
# next one 42 is not an influential observation
infl_obs <- c(11,73)
modfull3 <- lm(y[-infl_obs,] ~ X2[-infl_obs, -1])
rstud3 <- rstudent(modfull3)
id3 <- which.max(abs(rstud3))
abs(rstud3)[id3] > crit
# LINEAR
# first test, 11 is influential
hat_mat <- X2 %*% solve(t(X2) %*% X2) %*% t(X2)
yhatx2 <- X2 %*% BX2
errorest <- y - yhatx2
lev <- diag(hat_mat)
MSEX2 <- SSEX2 / (nrow(X2) - k)
stud_resid <- errorest / sqrt(as.numeric(MSEX2)) * sqrt(1 - lev)
id4 <- which.max(abs(stud_resid))
id4
abs(stud_resid)[id4] > crit
# 11 is true
#second test, 73 is influential
X2_rm11 <- X2[-11,]
hat_mat <- X2_rm11 %*% solve(t(X2_rm11) %*% X2_rm11) %*% t(X2_rm11)
yhatx2 <- X2_rm11 %*% BX2
errorest <- y[-11,] - yhatx2
lev <- diag(hat_mat)
MSEX2 <- SSEX2 / (nrow(X2_rm11) - k)
stud_resid <- errorest / sqrt(as.numeric(MSEX2)) * sqrt(1 - lev)
id5 <- which.max(abs(stud_resid))
id5
abs(stud_resid)[id5] > crit
#third test
inf <- c(11,73)
X2_rm_inf <- X2[-inf,]
hat_mat <- X2_rm_inf %*% solve(t(X2_rm_inf) %*% X2_rm_inf) %*% t(X2_rm_inf)
yhatx2 <- X2_rm_inf %*% BX2
errorest <- y[-inf] - yhatx2
lev <- diag(hat_mat)
MSEX2 <- SSEX2 / (nrow(X2_rm_inf) - k)
stud_resid <- errorest / sqrt(as.numeric(MSEX2)) * sqrt(1 - lev)
id6 <- which.max(abs(stud_resid))
id6
abs(stud_resid)[id6] > crit
# From class convo it is clear you wanted linear but I did rstud() method first
# initial observation
plot(modfull,1) #modfull is y ~ XZ (above)
# obs 11 is an influential observation, 73
rstud <- rstudent(modfull)
id1 <- which.max(abs(rstud))
n <- nrow(X2)
k <- 4
alpha <- 0.01
crit <- qt(1-alpha/2,n-k-1)
(abs(rstud)[id1] > crit)
# observation 73 is our next influential observation
modfull2 <- lm(y[-11,] ~ X2[-11, -1])
rstud2 <- rstudent(modfull2)
id2 <- which.max(abs(rstud2))
abs(rstud2)[id2] > crit
# next one 42 is not an influential observation
infl_obs <- c(11,73)
modfull3 <- lm(y[-infl_obs,] ~ X2[-infl_obs, -1])
rstud3 <- rstudent(modfull3)
id3 <- which.max(abs(rstud3))
abs(rstud3)[id3] > crit
# LINEAR
# first test, 11 is influential
hat_mat <- X2 %*% solve(t(X2) %*% X2) %*% t(X2)
yhatx2 <- X2 %*% BX2
errorest <- y - yhatx2
lev <- diag(hat_mat)
MSEX2 <- SSEX2 / (nrow(X2) - k)
stud_resid <- errorest / sqrt(as.numeric(MSEX2)) * sqrt(1 - lev)
id4 <- which.max(abs(stud_resid))
id4
abs(stud_resid)[id4] > crit
# 11 is true
#second test, 73 is influential
X2_rm11 <- X2[-11,]
hat_mat <- X2_rm11 %*% solve(t(X2_rm11) %*% X2_rm11) %*% t(X2_rm11)
yhatx2 <- X2_rm11 %*% BX2
errorest <- y[-11,] - yhatx2
lev <- diag(hat_mat)
MSEX2 <- SSEX2 / (nrow(X2_rm11) - k)
stud_resid <- errorest / sqrt(as.numeric(MSEX2)) * sqrt(1 - lev)
id5 <- which.max(abs(stud_resid))
id5
abs(stud_resid)[id5] > crit
#third test
inf <- c(11,73)
X2_rm_inf <- X2[-inf,]
hat_mat <- X2_rm_inf %*% solve(t(X2_rm_inf) %*% X2_rm_inf) %*% t(X2_rm_inf)
yhatx2 <- X2_rm_inf %*% BX2
errorest <- y[-inf] - yhatx2
lev <- diag(hat_mat)
MSEX2 <- SSEX2 / (nrow(X2_rm_inf) - k)
stud_resid <- errorest / sqrt(as.numeric(MSEX2)) * sqrt(1 - lev)
id6 <- which.max(abs(stud_resid))
id6
abs(stud_resid)[id6] > crit
library(tidyverse)
health <- read.csv("Data/lifeexp.csv")
# Scatterplots to see if we need to include a polynomial term
# Adult.Mortality - Linear
ggplot(health, aes(x = Adult.Mortality, y = Life.expectancy)) +
geom_point()
# infant.deaths - Polynomial
ggplot(health, aes(x = infant.deaths, y = Life.expectancy)) +
geom_point()+
xlim(0,75)
# Measles - no relationship
ggplot(health, aes(x = Measles, y = Life.expectancy)) +
geom_point()
# BMI - Linear
ggplot(health, aes(x = BMI, y = Life.expectancy)) +
geom_point()
# under.five.deaths - Polynomial
ggplot(health, aes(x = under.five.deaths, y = Life.expectancy)) +
geom_point()+
xlim(0,100)
# Polio - Polynomial
ggplot(health, aes(x = Polio, y = Life.expectancy)) +
geom_point()
# Diphtheria - Polynomial
ggplot(health, aes(x = Diphtheria, y = Life.expectancy)) +
geom_point()
# HIV.AIDS - Polynomial
ggplot(health, aes(x = HIV.AIDS, y = Life.expectancy)) +
geom_point()
# Income.composition.of.resources - Linear
ggplot(health, aes(x = Income.composition.of.resources, y = Life.expectancy)) +
geom_point()
# Schooling - Linear
ggplot(health, aes(x = Schooling, y = Life.expectancy)) +
geom_point()
mod_max <- lm(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health)
mod_best <- step(mod_max, direction = "both", trace = 0)
summary(mod_best)
library(leaps)
var_sel <- regsubsets(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health, method='backwards', nvmax = 100, really.big = TRUE))
library(leaps)
var_sel <- regsubsets(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health, method='backwards', nvmax = 100, really.big = TRUE)
library(leaps)
subset_sel <- regsubsets(formula(max_mod), data = health, nvmax = NULL, method = "backward")
library(leaps)
subset_sel <- regsubsets(formula(mod_max), data = health, nvmax = NULL, method = "backward")
library(leaps)
subset_sel <- regsubsets(formula(mod_max), data = health, nvmax = NULL, method = "backward")
library(leaps)
subset_sel <- regsubsets(formula(mod_max), data = health, nvmax = NULL, method = "backward")
library(leaps)
subset_sel <- regsubsets(formula(mod_max), data = health, nvmax = NULL, method = "backward")
View(subset_sel)
library(leaps)
subset_sel <- regsubsets(formula(mod_max), data = health, nvmax = NULL, method = "backward")
summary(subset_sel)
library(leaps)
subset_sel <- regsubsets(formula(mod_max), data = health, nvmax = NULL, method = "backward")
which.min(summary(subset_sel)$cp)
library(leaps)
subset_sel <- regsubsets(formula(mod_max), data = health, nvmax = NULL, method = "backward")
cp_mod <- which.min(summary(subset_sel)$cp)
library(leaps)
subset_sel <- regsubsets(formula(mod_max), data = health, nvmax = NULL, method = "backward")
cp_mod <- which.min(summary(subset_sel)$cp)
cp_mod
library(leaps)
subset_sel <- regsubsets(formula(mod_max), data = health, nvmax = NULL, method = "backward")
cp_mod <- which.min(subset_sel$cp)
library(leaps)
var_sel <- regsubsets(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health, method='backward', nvmax = 100, really.big = TRUE)
library(leaps)
var_sel <- regsubsets(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health, method='backward', nvmax = 100, really.big = TRUE)
summary(var_sel)
library(leaps)
var_sel <- regsubsets(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health, method='backward', nvmax = 100, really.big = TRUE)
which.min(summary(var_sel)$cp)
library(MASS)
library(tidyverse)
# lets start by looking at medv by crim
ggplot(Boston, aes(x = crim, y = medv)) +
geom_point()
# looks somewhat curved so lets include a quadratic term
# now, lets do medv by lstat
ggplot(Boston, aes(x = lstat, y = medv)) +
geom_point()
# looks like we should add a quadratic term
# you can look at other plots as well but we are skipping for time in class
mod_max <- lm(medv ~ .*. + I(crim^2) + I(lstat^2), Boston)
summary(mod_max)
# pvalues represent when its added to the model last,
# as in added when all other variables are added
mod_best1 <- step(mod_max, direction = "backward", trace = 0)
summary(mod_best1)
# trace = 0 does not include the trace of the variables
# added benefit for step function, output is an lm object
mod_best2 <- step(mod_max, direction = "both", trace = 0)
summary(mod_best2)
mod_max_log <- lm(log(medv) ~ .*. + I(crim^2) + I(lstat^2), Boston)
mod_best_log <- step(mod_max_log, direction = 'both', trace = 0)
plot(mod_best_log,1)
plot(mod_best_log,2)
# the leaps package contains multiple functions to perform variable selection by multiple different methods.
# specifically, the regsubsets() function
# bad news: does not directly output a linear model
library(leaps)
var_sel <- regsubsets(medv ~ .*. + I(crim^2) + I(lstat^2), Boston, method='seqrep', nvmax = 100, really.big = TRUE)
#summary(var_sel)
# summary shows which variables are included when we have only one variable model, 2 variable model, etc
summary(var_sel)$cp #mallows cp for the models with the given number of variables
summary(var_sel)$adjr2
which.min(summary(var_sel)$cp) #model that minimizes mallows cp
which.max(summary(var_sel)$adjr2)
coef(var_sel,47)
coef(var_sel, 53)
library(leaps)
var_sel <- regsubsets(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health, method='backward', nvmax = 100, really.big = TRUE)
which.min(summary(var_sel)$cp)
coef(var_sel,32)
library(tidyverse)
health <- read.csv("Data/lifeexp.csv")
# Scatterplots to see if we need to include a polynomial term
# Adult.Mortality - Linear
ggplot(health, aes(x = Adult.Mortality, y = Life.expectancy)) +
geom_point()
# infant.deaths - Polynomial
ggplot(health, aes(x = infant.deaths, y = Life.expectancy)) +
geom_point()+
xlim(0,75)
# Measles - no relationship
ggplot(health, aes(x = Measles, y = Life.expectancy)) +
geom_point()
# BMI - Linear
ggplot(health, aes(x = BMI, y = Life.expectancy)) +
geom_point()
# under.five.deaths - Polynomial
ggplot(health, aes(x = under.five.deaths, y = Life.expectancy)) +
geom_point()+
xlim(0,100)
# Polio - Polynomial
ggplot(health, aes(x = Polio, y = Life.expectancy)) +
geom_point()
# Diphtheria - Polynomial
ggplot(health, aes(x = Diphtheria, y = Life.expectancy)) +
geom_point()
# HIV.AIDS - Polynomial
ggplot(health, aes(x = HIV.AIDS, y = Life.expectancy)) +
geom_point()
# Income.composition.of.resources - Linear
ggplot(health, aes(x = Income.composition.of.resources, y = Life.expectancy)) +
geom_point()
# Schooling - Linear
ggplot(health, aes(x = Schooling, y = Life.expectancy)) +
geom_point()
mod_max <- lm(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health)
mod_best <- step(mod_max, direction = "both", trace = 0)
summary(mod_best)
library(leaps)
var_sel <- regsubsets(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health, method='backward', nvmax = 100, really.big = TRUE)
which.min(summary(var_sel)$cp)
coef(var_sel,32)
best_modelAIC <- lm(
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
AICmodel <- lm(
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
mallows_model <- lm(
Life.expectancy ~
Status + BMI + Diphtheria +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Measles + Status:Diphtheria + Status:HIV.AIDS +
Adult.Mortality:BMI + Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria + Adult.Mortality:Schooling +
infant.deaths:BMI + infant.deaths:Polio + infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS + Measles:BMI + Measles:under.five.deaths +
Measles:Polio + Measles:HIV.AIDS + BMI:Diphtheria +
BMI:HIV.AIDS + BMI:Schooling +
under.five.deaths:Diphtheria + under.five.deaths:HIV.AIDS +
Polio:Diphtheria + Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS + HIV.AIDS:Schooling,
data = health
)
AICmodel <- lm(
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
mallows_model <- lm(
Life.expectancy ~
Status + BMI + Diphtheria +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Measles + Status:Diphtheria + Status:HIV.AIDS +
Adult.Mortality:BMI + Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria + Adult.Mortality:Schooling +
infant.deaths:BMI + infant.deaths:Polio + infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS + Measles:BMI + Measles:under.five.deaths +
Measles:Polio + Measles:HIV.AIDS + BMI:Diphtheria +
BMI:HIV.AIDS + BMI:Schooling +
under.five.deaths:Diphtheria + under.five.deaths:HIV.AIDS +
Polio:Diphtheria + Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS + HIV.AIDS:Schooling,
data = health
)
AIC(AICmodel, mallows_model)
best_final_model <- lm(
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
library(lmtest)
install.packages('lmtest')
library(lmtest)
library(lmtest)
plot(best_final_model,1)
bptest(best_final_model)
plot(best_final_model,2)
ks.test(rstandard(best_final_model),"pnorm")
