grepl("M", Value) ~ as.numeric(gsub("M", "", Value)) * 1e6,
grepl("K", Value) ~ as.numeric(gsub("K", "", Value)) * 1e3,
TRUE ~ as.numeric(Value)
),
Height = as.numeric(gsub("cm", "", Height)),
Weight = as.numeric(gsub("kg", "", Weight))
) %>%
# ---- Remove problematic rows ----
filter(is.finite(Value), Value > 0) %>%
na.omit()
library(tidyverse)
fifa <- read.csv('FIFA22_official_data.csv')
head(fifa)
names(fifa)
library(tidyverse)
fifa <- read.csv('FIFA22_official_data.csv')
head(fifa)
names(fifa)
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness) %>%
# ---- Convert Value strings ("€100M", "€80K") to numeric ----
mutate(
Value = gsub("€", "", Value),
Value = case_when(
grepl("M", Value) ~ as.numeric(gsub("M", "", Value)) * 1e6,
grepl("K", Value) ~ as.numeric(gsub("K", "", Value)) * 1e3,
TRUE ~ as.numeric(Value)
),
Height = as.numeric(gsub("cm", "", Height)),
Weight = as.numeric(gsub("kg", "", Weight))
) %>%
# ---- Remove problematic rows ----
filter(is.finite(Value), Value > 0) %>%
na.omit()
mod_initial <- lm(Value ~ ., fifa_clean)
summary(mod_initial)
plot(mod_initial,1)
plot(mod_initial,2)
# need to do a select(-value before importing mass bc it overrides select)
fifa_clean <- fifa_clean %>%
select(-Value)
# boxcox analysis to see if we should do a log transformation
library(MASS)
bc <- boxcox(mod_initial)
# need to do a select(-value before importing mass bc it overrides select)
fifa_clean <- fifa_clean %>%
select(-Value)
# need to do a select(-value before importing mass bc it overrides select)
fifa_clean <- fifa_clean %>%
select(-Value)
# need to do a select(-value before importing mass bc it overrides select)
fifa_clean <- fifa_clean %>%
select(-Value)
# log transformation
fifa_clean <- fifa_clean %>%
mutate(Value_bc = log(Value))
# log transformation
fifa_clean <- fifa_clean %>%
mutate(Value_bc = log(Value))
library(tidyverse)
fifa <- read.csv('FIFA22_official_data.csv')
head(fifa)
names(fifa)
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness) %>%
# ---- Convert Value strings ("€100M", "€80K") to numeric ----
mutate(
Value = gsub("€", "", Value),
Value = case_when(
grepl("M", Value) ~ as.numeric(gsub("M", "", Value)) * 1e6,
grepl("K", Value) ~ as.numeric(gsub("K", "", Value)) * 1e3,
TRUE ~ as.numeric(Value)
),
Height = as.numeric(gsub("cm", "", Height)),
Weight = as.numeric(gsub("kg", "", Weight))
) %>%
# ---- Remove problematic rows ----
filter(is.finite(Value), Value > 0) %>%
na.omit()
# log transformation
fifa_clean <- fifa_clean %>%
mutate(Value_bc = log(Value))
library(tidyverse)
fifa <- read.csv('FIFA22_official_data.csv')
head(fifa)
names(fifa)
library(tidyverse)
fifa <- read.csv('FIFA22_official_data.csv')
head(fifa)
names(fifa)
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness) %>%
# ---- Convert Value strings ("€100M", "€80K") to numeric ----
mutate(
Value = gsub("€", "", Value),
Value = case_when(
grepl("M", Value) ~ as.numeric(gsub("M", "", Value)) * 1e6,
grepl("K", Value) ~ as.numeric(gsub("K", "", Value)) * 1e3,
TRUE ~ as.numeric(Value)
),
Height = as.numeric(gsub("cm", "", Height)),
Weight = as.numeric(gsub("kg", "", Weight))
) %>%
# ---- Remove problematic rows ----
filter(is.finite(Value), Value > 0) %>%
na.omit()
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
dplyr::select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness) %>%
# ---- Convert Value strings ("€100M", "€80K") to numeric ----
mutate(
Value = gsub("€", "", Value),
Value = case_when(
grepl("M", Value) ~ as.numeric(gsub("M", "", Value)) * 1e6,
grepl("K", Value) ~ as.numeric(gsub("K", "", Value)) * 1e3,
TRUE ~ as.numeric(Value)
),
Height = as.numeric(gsub("cm", "", Height)),
Weight = as.numeric(gsub("kg", "", Weight))
) %>%
# ---- Remove problematic rows ----
filter(is.finite(Value), Value > 0) %>%
na.omit()
mod_initial <- lm(Value ~ ., fifa_clean)
summary(mod_initial)
plot(mod_initial,1)
plot(mod_initial,2)
# boxcox analysis to see if we should do a log transformation
library(MASS)
bc <- boxcox(mod_initial)
lambda <- bc$x[which.max(bc$y)]
lambda
# log transformation
fifa_clean <- fifa_clean %>%
mutate(Value_bc = log(Value))
mod_bc <- lm(Value_bc ~ ., data = fifa_clean %>% select(-Value))
mod_bc <- lm(Value_bc ~ ., data = fifa_clean %>% dplyr:select(-Value))
mod_bc <- lm(Value_bc ~ ., data = fifa_clean %>% dplyr::select(-Value))
summary(mod_bc)
# Diagnostic plots
plot(mod_bc, 1)
plot(mod_bc, 2)
res <- abs(residuals(mod_bc))
w <- res^2
mod_wls <- lm(Value_bc ~ .,
data = fifa_clean %>% select(-Value),
weights = w)
res <- abs(residuals(mod_bc))
w <- res^2
mod_wls <- lm(Value_bc ~ .,
data = fifa_clean %>% dplyr::select(-Value),
weights = w)
plot(mod_wls, 1)
plot(mod_wls, 2)
summary(mod_wls)
mod_bc$rsquared
mod_bc$adjrsquared
mod_bc$adj.r.squared
summary(mod_bc)$adj.r.squared
diff_rsquared <- summary(mod_bc)$adj.r.squared - summary(mod_wls)$adj.r.squared
diff_rsquared <- summary(mod_bc)$adj.r.squared - summary(mod_wls)$adj.r.squared
diff_rsquared
diff_rsquared <- summary(mod_bc)$adj.r.squared - summary(mod_wls)$adj.r.squared
diff_rsquared * 100
mod_initial <- lm(Value ~ ., fifa_clean)
plot(mod_initial,1)
plot(mod_initial,2)
mod_initial <- lm(Value ~ ., fifa_clean)
summary(mod_initial)
plot(mod_initial,1)
plot(mod_initial,2)
diff_wts_log <- summary(mod_bc)$adj.r.squared - summary(mod_wls)$adj.r.squared
diff_rsquared * 100
diff_wts_log <- summary(mod_bc)$adj.r.squared - summary(mod_wls)$adj.r.squared
diff_wts_log * 100
dif_norm_log <- summary(mod_initial)$adj.r.squared - summary(mod_bc)$adj.r.squared
diff_wts_log <- summary(mod_bc)$adj.r.squared - summary(mod_wls)$adj.r.squared
diff_wts_log * 100
dif_norm_log <- summary(mod_initial)$adj.r.squared - summary(mod_bc)$adj.r.squared
diff_norm_log * 100
diff_norm_log <- summary(mod_initial)$adj.r.squared - summary(mod_bc)$adj.r.squared
diff_norm_log * 100
diff_wts_log <- summary(mod_bc)$adj.r.squared - summary(mod_wls)$adj.r.squared
diff_wts_log * 100
diff_norm_log <- summary(mod_bc)$adj.r.squared - summary(mod_initial)$adj.r.squared
diff_norm_log * 100
diff_wts_log <- summary(mod_bc)$adj.r.squared - summary(mod_wls)$adj.r.squared
diff_wts_log * 100
diff_norm_log <- summary(mod_bc)$adj.r.squared - summary(mod_initial)$adj.r.squared
diff_norm_log * 100
diff_wts_log <- summary(mod_wls)$adj.r.squared - summary(mod_bc)$adj.r.squared
diff_wts_log * 100
diff_norm_log <- summary(mod_bc)$adj.r.squared - summary(mod_initial)$adj.r.squared
diff_norm_log * 100
diff_wts_log <- summary(mod_wls)$adj.r.squared - summary(mod_bc)$adj.r.squared
diff_wts_log * 100
summary(mod_bc)
mod_bc <- lm(Value_bc ~ ., data = fifa_clean %>% dplyr::select(-Value))
summary(mod_bc)
# Diagnostic plots
plot(mod_bc, 1)
plot(mod_bc, 2)
summary(mod_bc)
library(tidyverse)
fifa <- read.csv('FIFA22_official_data.csv')
head(fifa)
names(fifa)
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
dplyr::select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness) %>%
# ---- Convert Value strings ("€100M", "€80K") to numeric ----
mutate(
Value = gsub("€", "", Value),
Value = case_when(
grepl("M", Value) ~ as.numeric(gsub("M", "", Value)) * 1e6,
grepl("K", Value) ~ as.numeric(gsub("K", "", Value)) * 1e3,
TRUE ~ as.numeric(Value)
),
Height = as.numeric(gsub("cm", "", Height)),
Weight = as.numeric(gsub("kg", "", Weight))
) %>%
# ---- Remove problematic rows ----
filter(is.finite(Value), Value > 0) %>%
na.omit()
mod_initial <- lm(Value ~ ., fifa_clean)
summary(mod_initial)
plot(mod_initial,1)
plot(mod_initial,2)
# boxcox analysis to see if we should do a log transformation
library(MASS)
bc <- boxcox(mod_initial)
lambda <- bc$x[which.max(bc$y)]
lambda
# log transformation
fifa_clean <- fifa_clean %>%
mutate(Value_bc = log(Value))
mod_bc <- lm(Value_bc ~ ., data = fifa_clean %>% dplyr::select(-Value))
summary(mod_bc)
# Diagnostic plots
plot(mod_bc, 1)
plot(mod_bc, 2)
summary(mod_bc)
res <- abs(residuals(mod_bc))
w <- res^2
mod_wls <- lm(Value_bc ~ .,
data = fifa_clean %>% dplyr::select(-Value),
weights = w)
plot(mod_wls, 1)
plot(mod_wls, 2)
summary(mod_wls)
diff_norm_log <- summary(mod_bc)$adj.r.squared - summary(mod_initial)$adj.r.squared
diff_norm_log * 100
diff_wts_log <- summary(mod_wls)$adj.r.squared - summary(mod_bc)$adj.r.squared
diff_wts_log * 100
P_D <- 0.02
P_PD <- 0.99
P_NDc <- 0.95
P_P <- P_PD * P_D + (1 - P_NDc) * (1 - P_D)
P_PD * P_D / P_P
library(shiny)
library(ggplot2)
# UI
ui <- fluidPage(
titlePanel("b-Binomial Prior vs Posterior"),
sidebarLayout(
sidebarPanel(
h3("Prior Parameters"),
numericInput("a", "a", value = 2, min = 0.1, step = 0.1),
numericInput("b", "b", value = 2, min = 0.1, step = 0.1),
hr(),
h3("Observed Data"),
numericInput("n", "Number of Trials (n)", value = 10, min = 1, step = 1),
numericInput("k", "Number of Successes (x)", value = 5, min = 0, step = 1),
hr(),
actionButton("update", "Update")
),
mainPanel(
plotOutput("distPlot")
)
)
)
# Server
server <- function(input, output) {
reactive_values <- reactiveValues()
observeEvent(input$update, {
# Capture inputs
a_prior <- input$a
b_prior <- input$b
n <- input$n
k <- input$k
# Posterior parameters
a_post <- a_prior + k
b_post <- b_prior + n - k
# Data for visualization
x <- seq(0, 1, length.out = 500)
prior <- dbeta(x, a_prior, b_prior)
posterior <- dbeta(x, a_post, b_post)
reactive_values$data <- data.frame(
x = c(x, x),
y = c(prior, posterior),
Distribution = rep(c("Prior", "Posterior"), each = length(x))
)
})
output$distPlot <- renderPlot({
req(reactive_values$data)
ggplot(reactive_values$data, aes(x = x, y = y, color = Distribution)) +
geom_line(size = 1.2) +
labs(
title = "Prior vs Posterior Distribution",
x = "Probability of Success (θ)",
y = "Density"
) +
theme_minimal() +
theme(legend.title = element_blank())
})
output$posteriorParams <- renderText({
req(reactive_values$posteriorParams)
reactive_values$posteriorParams
})
}
# Run the app
shinyApp(ui = ui, server = server)
charges
charges <- read.csv()
charges <- read.csv('../Multiple Linear Regression/insurance.csv')
charges <- read.csv('../Multiple_Linear_Regression/insurance.csv')
insurance <- read_csv("Multiple Linear Regression/Data/insurance.csv")
insurance <- read.csv("Multiple Linear Regression/Data/insurance.csv")
library(readr)
insurance <- read_csv("Multiple Linear Regression/Data/insurance.csv")
View(insurance)
insurance <- read.csv("Multiple Linear Regression/Data/insurance.csv")
insurance <- read.csv("./Multiple Linear Regression/Data/insurance.csv")
insurance <- read.csv("../Multiple Linear Regression/Data/insurance.csv")
y <- insurance$charges
x <- model.matrix(charges ~ ., insurance)
# prior hyperparameters
insurance <- read.csv("../Multiple Linear Regression/Data/insurance.csv")
y <- insurance$charges
x <- model.matrix(charges ~ ., insurance)
# prior hyperparameters
insurance <- read.csv("../Multiple Linear Regression/Data/insurance.csv")
y <- insurance$charges
x <- model.matrix(charges ~ ., insurance)
# prior hyperparameters
insurance <- read.csv("../Multiple Linear Regression/Data/insurance.csv")
y <- insurance$charges
x <- model.matrix(charges ~ ., insurance)
# prior hyperparameters
k <- ncol(X) # number of parameters
insurance <- read.csv("../Multiple Linear Regression/Data/insurance.csv")
y <- insurance$charges
x <- model.matrix(charges ~ ., insurance)
# prior hyperparameters
k <- ncol(X) # number of parameters
insurance <- read.csv("../Multiple Linear Regression/Data/insurance.csv")
y <- insurance$charges
X <- model.matrix(charges ~ ., insurance)
# prior hyperparameters
k <- ncol(X) # number of parameters
m <- rep(0,k)
insurance <- read.csv("../Multiple Linear Regression/Data/insurance.csv")
y <- insurance$charges
X <- model.matrix(charges ~ ., insurance)
# prior hyperparameters
k <- ncol(X) # number of parameters
m <- rep(0,k)
A <- diag(k)
MAP <- solve(t(X) %x% X + solve(A)) %*% (t(X) %*% y + solve(A) %*% m)
insurance <- read.csv("../Multiple Linear Regression/Data/insurance.csv")
y <- insurance$charges
X <- model.matrix(charges ~ ., insurance)
# prior hyperparameters
k <- ncol(X) # number of parameters
m <- rep(0,k)
A <- diag(k)
MAP <- solve(t(X) %x% X + solve(A)) %*% (t(X) %*% y + solve(A) %*% m)
insurance <- read.csv("../Multiple Linear Regression/Data/insurance.csv")
y <- insurance$charges
X <- model.matrix(charges ~ ., insurance)
# prior hyperparameters
k <- ncol(X) # number of parameters
m <- rep(0,k)
A <- diag(k)
MAP <- solve(t(X) %x% X + solve(A)) %*% (t(X) %*% y + solve(A) %*% m)
insurance <- read.csv("../Multiple Linear Regression/Data/insurance.csv")
y <- insurance$charges
X <- model.matrix(charges ~ ., insurance)
# prior hyperparameters
k <- ncol(X) # number of parameters
m <- rep(0,k)
A <- diag(k)
MAP <- solve(t(X) %x% X + solve(A)) %*% (t(X) %*% y + solve(A) %*% m)
P_D <- 0.02
P_PD <- 0.99
P_NDc <- 0.95
P_P <- P_PD * P_D + (1 - P_NDc) * (1 - P_D)
P_PD * P_D / P_P
library(shiny)
library(ggplot2)
# UI
ui <- fluidPage(
titlePanel("b-Binomial Prior vs Posterior"),
sidebarLayout(
sidebarPanel(
h3("Prior Parameters"),
numericInput("a", "a", value = 2, min = 0.1, step = 0.1),
numericInput("b", "b", value = 2, min = 0.1, step = 0.1),
hr(),
h3("Observed Data"),
numericInput("n", "Number of Trials (n)", value = 10, min = 1, step = 1),
numericInput("k", "Number of Successes (x)", value = 5, min = 0, step = 1),
hr(),
actionButton("update", "Update")
),
mainPanel(
plotOutput("distPlot")
)
)
)
# Server
server <- function(input, output) {
reactive_values <- reactiveValues()
observeEvent(input$update, {
# Capture inputs
a_prior <- input$a
b_prior <- input$b
n <- input$n
k <- input$k
# Posterior parameters
a_post <- a_prior + k
b_post <- b_prior + n - k
# Data for visualization
x <- seq(0, 1, length.out = 500)
prior <- dbeta(x, a_prior, b_prior)
posterior <- dbeta(x, a_post, b_post)
reactive_values$data <- data.frame(
x = c(x, x),
y = c(prior, posterior),
Distribution = rep(c("Prior", "Posterior"), each = length(x))
)
})
output$distPlot <- renderPlot({
req(reactive_values$data)
ggplot(reactive_values$data, aes(x = x, y = y, color = Distribution)) +
geom_line(size = 1.2) +
labs(
title = "Prior vs Posterior Distribution",
x = "Probability of Success (θ)",
y = "Density"
) +
theme_minimal() +
theme(legend.title = element_blank())
})
output$posteriorParams <- renderText({
req(reactive_values$posteriorParams)
reactive_values$posteriorParams
})
}
# Run the app
shinyApp(ui = ui, server = server)
insurance <- read.csv("../Multiple Linear Regression/Data/insurance.csv")
y <- insurance$charges
X <- model.matrix(charges ~ ., insurance)
# prior hyperparameters
k <- ncol(X) # number of parameters
m <- rep(0,k)
A <- diag(k)
MAP <- solve(t(X) %x% X + solve(A)) %*% (t(X) %*% y + solve(A) %*% m)
insurance <- read.csv("../Multiple Linear Regression/Data/insurance.csv")
y <- insurance$charges
X <- model.matrix(charges ~ ., insurance)
# prior hyperparameters
k <- ncol(X) # number of parameters
m <- rep(0,k)
A <- diag(k)
MAP <- solve(t(X) %*% X + solve(A)) %*% (t(X) %*% y + solve(A) %*% m)
View(MAP)
gc()
