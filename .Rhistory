data = health
)
Mallows_model <- lm(
Life.expectancy ~
Status + BMI + Diphtheria +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Measles + Status:Diphtheria + Status:HIV.AIDS +
Adult.Mortality:BMI + Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria + Adult.Mortality:Schooling +
infant.deaths:BMI + infant.deaths:Polio + infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS + Measles:BMI + Measles:under.five.deaths +
Measles:Polio + Measles:HIV.AIDS +
BMI:Diphtheria + BMI:HIV.AIDS + BMI:Schooling +
under.five.deaths:Diphtheria + under.five.deaths:HIV.AIDS +
Polio:Diphtheria + Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS + HIV.AIDS:Schooling,
data = health
)
summary(Mallows_model).r2
AIC_model <- lm(
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
Mallows_model <- lm(
Life.expectancy ~
Status + BMI + Diphtheria +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Measles + Status:Diphtheria + Status:HIV.AIDS +
Adult.Mortality:BMI + Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria + Adult.Mortality:Schooling +
infant.deaths:BMI + infant.deaths:Polio + infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS + Measles:BMI + Measles:under.five.deaths +
Measles:Polio + Measles:HIV.AIDS +
BMI:Diphtheria + BMI:HIV.AIDS + BMI:Schooling +
under.five.deaths:Diphtheria + under.five.deaths:HIV.AIDS +
Polio:Diphtheria + Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS + HIV.AIDS:Schooling,
data = health
)
summary(Mallows_model).R2
AIC_model <- lm(
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
Mallows_model <- lm(
Life.expectancy ~
Status + BMI + Diphtheria +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Measles + Status:Diphtheria + Status:HIV.AIDS +
Adult.Mortality:BMI + Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria + Adult.Mortality:Schooling +
infant.deaths:BMI + infant.deaths:Polio + infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS + Measles:BMI + Measles:under.five.deaths +
Measles:Polio + Measles:HIV.AIDS +
BMI:Diphtheria + BMI:HIV.AIDS + BMI:Schooling +
under.five.deaths:Diphtheria + under.five.deaths:HIV.AIDS +
Polio:Diphtheria + Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS + HIV.AIDS:Schooling,
data = health
)
summary(Mallows_model).rsquared
AIC_model <- lm(
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
Mallows_model <- lm(
Life.expectancy ~
Status + BMI + Diphtheria +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Measles + Status:Diphtheria + Status:HIV.AIDS +
Adult.Mortality:BMI + Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria + Adult.Mortality:Schooling +
infant.deaths:BMI + infant.deaths:Polio + infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS + Measles:BMI + Measles:under.five.deaths +
Measles:Polio + Measles:HIV.AIDS +
BMI:Diphtheria + BMI:HIV.AIDS + BMI:Schooling +
under.five.deaths:Diphtheria + under.five.deaths:HIV.AIDS +
Polio:Diphtheria + Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS + HIV.AIDS:Schooling,
data = health
)
summary(Mallows_model)rsquared
library(leaps)
var_sel <- regsubsets(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health, method='backward', nvmax = 100, really.big = TRUE)
which.min(summary(var_sel)$cp)
coef(var_sel,32)
(summary(var_sel,32)$ajdr2)
library(leaps)
var_sel <- regsubsets(Life.expectancy ~ .*. + I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +I(Diphtheria^2) + I(HIV.AIDS^2), health, method='backward', nvmax = 100, really.big = TRUE)
which.min(summary(var_sel)$cp)
coef(var_sel,32)
AIC_model <- lm(
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
Mallows_model <- lm(
Life.expectancy ~
Status + BMI + Diphtheria +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Measles + Status:Diphtheria + Status:HIV.AIDS +
Adult.Mortality:BMI + Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria + Adult.Mortality:Schooling +
infant.deaths:BMI + infant.deaths:Polio + infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS + Measles:BMI + Measles:under.five.deaths +
Measles:Polio + Measles:HIV.AIDS +
BMI:Diphtheria + BMI:HIV.AIDS + BMI:Schooling +
under.five.deaths:Diphtheria + under.five.deaths:HIV.AIDS +
Polio:Diphtheria + Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS + HIV.AIDS:Schooling,
data = health
)
(summary(Mallows_model)$ajdr2)
(summary(AIC_model)$ajdr2)
AIC_model <- lm(
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
Mallows_model <- lm(
Life.expectancy ~
Status + BMI + Diphtheria +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Measles + Status:Diphtheria + Status:HIV.AIDS +
Adult.Mortality:BMI + Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria + Adult.Mortality:Schooling +
infant.deaths:BMI + infant.deaths:Polio + infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS + Measles:BMI + Measles:under.five.deaths +
Measles:Polio + Measles:HIV.AIDS +
BMI:Diphtheria + BMI:HIV.AIDS + BMI:Schooling +
under.five.deaths:Diphtheria + under.five.deaths:HIV.AIDS +
Polio:Diphtheria + Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS + HIV.AIDS:Schooling,
data = health
)
summary(Mallows_model)
summary(AIC_model)
AIC_model <- lm(
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
Mallows_model <- lm(
Life.expectancy ~
Status + BMI + Diphtheria +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Measles + Status:Diphtheria + Status:HIV.AIDS +
Adult.Mortality:BMI + Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria + Adult.Mortality:Schooling +
infant.deaths:BMI + infant.deaths:Polio + infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS + Measles:BMI + Measles:under.five.deaths +
Measles:Polio + Measles:HIV.AIDS +
BMI:Diphtheria + BMI:HIV.AIDS + BMI:Schooling +
under.five.deaths:Diphtheria + under.five.deaths:HIV.AIDS +
Polio:Diphtheria + Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS + HIV.AIDS:Schooling,
data = health
)
summary(Mallows_model)
summary(AIC_model)
anova(Mallows_model,AIC_model)
AIC_model <- lm(
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
Mallows_model <- lm(
Life.expectancy ~
Status + BMI + Diphtheria +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Measles + Status:Diphtheria + Status:HIV.AIDS +
Adult.Mortality:BMI + Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria + Adult.Mortality:Schooling +
infant.deaths:BMI + infant.deaths:Polio + infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS + Measles:BMI + Measles:under.five.deaths +
Measles:Polio + Measles:HIV.AIDS +
BMI:Diphtheria + BMI:HIV.AIDS + BMI:Schooling +
under.five.deaths:Diphtheria + under.five.deaths:HIV.AIDS +
Polio:Diphtheria + Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS + HIV.AIDS:Schooling,
data = health
)
summary(Mallows_model)
summary(AIC_model)
anova(AIC_model,Mallows_model)
AIC_model <- lm(
Life.expectancy ~
Status + Adult.Mortality + infant.deaths + Measles + BMI +
under.five.deaths + Polio + Diphtheria + HIV.AIDS +
Income.composition.of.resources + Schooling +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Adult.Mortality + Status:Measles + Status:Diphtheria +
Adult.Mortality:Measles + Adult.Mortality:Polio +
Adult.Mortality:Income.composition.of.resources +
infant.deaths:BMI + infant.deaths:under.five.deaths +
infant.deaths:Polio + infant.deaths:Diphtheria +
Measles:BMI + Measles:Polio + Measles:Diphtheria +
BMI:under.five.deaths + BMI:Polio + BMI:Schooling +
under.five.deaths:Polio + under.five.deaths:Diphtheria +
under.five.deaths:HIV.AIDS +
under.five.deaths:Income.composition.of.resources +
under.five.deaths:Schooling +
Polio:HIV.AIDS + Polio:Schooling +
Diphtheria:Income.composition.of.resources + Diphtheria:Schooling +
HIV.AIDS:Income.composition.of.resources +
Income.composition.of.resources:Schooling,
data = health
)
Mallows_model <- lm(
Life.expectancy ~
Status + BMI + Diphtheria +
I(infant.deaths^2) + I(under.five.deaths^2) + I(Polio^2) +
I(Diphtheria^2) + I(HIV.AIDS^2) +
Status:Measles + Status:Diphtheria + Status:HIV.AIDS +
Adult.Mortality:BMI + Adult.Mortality:under.five.deaths +
Adult.Mortality:Diphtheria + Adult.Mortality:Schooling +
infant.deaths:BMI + infant.deaths:Polio + infant.deaths:Diphtheria +
infant.deaths:HIV.AIDS + Measles:BMI + Measles:under.five.deaths +
Measles:Polio + Measles:HIV.AIDS +
BMI:Diphtheria + BMI:HIV.AIDS + BMI:Schooling +
under.five.deaths:Diphtheria + under.five.deaths:HIV.AIDS +
Polio:Diphtheria + Polio:Income.composition.of.resources +
Diphtheria:HIV.AIDS + HIV.AIDS:Schooling,
data = health
)
anova(AIC_model,Mallows_model)
# p <
library(tidyverse)
award <- read.csv('Data/awards.csv')
# using poisson bc awards is a count variable
mod <- glm(num_awards ~ prog + math, family = poisson, data = award)
summary(mod)
confint(mod, 'progVocational')
exp(-1.3905775)
exp(-0.1261624)
confint(mod, 'progVocational')
summary(mod)
chi2 <- summary(mod)$null - summary(mod)$deviance
chi2
chi2 <- summary(mod)$null - summary(mod)$deviance
chi2
chi2 <- summary(mod)$null - summary(mod)$deviance
chi2
pchisq(chi2,3,lower.tail = FALSE)
chi2 <- mod$null.deviance - mod$deviance
df   <- mod$df.null - mod$df.residual
pchisq(chi2, df, lower.tail = FALSE)
chi2 <- mod$null.deviance - mod$deviance
chi2
df   <- mod$df.null - mod$df.residual
df
pchisq(chi2, df, lower.tail = FALSE)
chi2 <- mod$null.deviance - mod$deviance
chi2
df   <- mod$df.null - mod$df.residual
df
pchisq(chi2, df, lower.tail = FALSE)
summary(mod)
chi2 <- mod$null.deviance - mod$deviance
df   <- mod$df.null - mod$df.residual
pchisq(chi2, df, lower.tail = FALSE)
summary(mod)
summary(mod)
chi2 <- mod$null.deviance - mod$deviance
df   <- mod$df.null - mod$df.residual
pchisq(chi2, df, lower.tail = FALSE)
summary(mod)
chi2 <- mod$null.deviance - mod$deviance
df   <- mod$df.null - mod$df.residual
pchisq(chi2, df, lower.tail = FALSE)
chi2
View(award)
mod_int <- glm(num_awards ~ .*., data = award, family = poisson)
mod_int <- glm(num_awards ~ .*., data = award, family = poisson)
summary(mod_int)
mod_int <- glm(num_awards ~ prog + math + prog:math, data = award, family = poisson)
summary(mod_int)
Bikes <- read.csv('Data/NYC_Bikes.csv')
View(Bikes)
# convert precipitation to numeric
Bikes$Precipitation[Bikes$Precipitation == 'T'] <- 0
Bikes$Precipitation[Bikes$Precipitation == '0.47 (S)'] <- 0.47
Bikes$Precipitation <- as.numeric(Bikes$Precipitation)
mod_pois <- glm(Brooklyn.Bridge ~ High.Temp...F. + Low.Temp...F. + Precipitation, Bikes, family = poisson())
summary(mod_pois)
mod_int <- glm(num_awards ~ prog + math + prog:math, data = award, family = poisson)
anova(mod_int, mod)
summary(mod)
plot(mod,1)
plot(mod,1)
plot(mod,2)
plot(mod,1)
plot(mod,2)
library(lmtest)
lmtest
plot(mod,1)
plot(mod,2)
library(lmtest)
?lmtest
lmtest
??lmtest
plot(mod,1)
plot(mod,2)
library(lmtest)
bptest(mod)
plot(mod,1)
plot(mod,2)
library(lmtest)
bptest(mod)
ks.test(rstandard(mod)
plot(mod,1)
plot(mod,2)
library(lmtest)
bptest(mod)
ks.test(rstandard(mod))
plot(mod,1)
plot(mod,2)
library(lmtest)
bptest(mod)
ks.test(rstandard(mod), 'pnorm')
library(tidyverse)
award <- read.csv('Data/awards.csv')
# using poisson bc awards is a count variable
mod <- glm(num_awards ~ prog + math, family = poisson, data = award)
summary(mod)
confint(mod, 'progVocational')
summary(mod)
chi2 <- mod$null.deviance - mod$deviance
df   <- mod$df.null - mod$df.residual
pchisq(chi2, df, lower.tail = FALSE)
chi2
library(tidyverse)
fifa <- read.csv('FIFA22_official_data.csv')
head(fifa)
View(fifa)
# ideas for things to predict market Value... Age, Nationality, Overall, Club, Preferred.Foot, Skill.Moves, Body.Type, Height, Wright, Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys, Dribbling, Curve, FKAccuracy, LongPassing, BallControl, Acceleration, SprintSpeed, Agility, Reactions, Balance, ShotPower, Jumping, Stamina, Strength, LongShots, Aggression, Interceptions, Positioning, Vision, Penalties, Composure, StandingTackle, SlidingTackle, DefensiveAwareness
#removed club and nationality for fun reasons and body type
fifa_new <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight, Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys, Dribbling, Curve, FKAccuracy, LongPassing, BallControl, Acceleration, SprintSpeed, Agility, Reactions, Balance, ShotPower, Jumping, Stamina, Strength, LongShots, Aggression, Interceptions, Positioning, Vision, Penalties, Composure, StandingTackle, SlidingTackle, DefensiveAwareness
)
View(fifa_new)
fifa_clean <- fifa_new %>%
mutate(
# --- Clean Value ---
Value = gsub("â‚¬", "", Value),
Value = case_when(
grepl("M", Value) ~ as.numeric(gsub("M", "", Value)) * 1e6,
grepl("K", Value) ~ as.numeric(gsub("K", "", Value)) * 1e3,
TRUE ~ as.numeric(Value)
),
# --- Clean Height (remove "cm" and convert to numeric) ---
Height = as.numeric(gsub("cm", "", Height)),
# --- Clean Weight (remove "kg" and convert to numeric) ---
Weight = as.numeric(gsub("kg", "", Weight))
) %>%
# Remove rows with missing or infinite values
filter(!is.na(Value), is.finite(Value)) %>%
na.omit()
View(fifa_clean)
mod <- lm(Value ~ ., fifa_clean)
View(mod)
summary(mod)
plot(mod)
#weights or boxcox
summary(mod)
plot(mod)
#weights or boxcox
