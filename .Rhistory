# Simulate the dataset
## arima.sim simulates a stationary time series dataset
## AR1 parameter 0.7 (beta1)
## MA1 parameter 0.5 (theta1)
set.seed(100618)
dat <- arima.sim(model=list(ar = 0.7, ma=0.5), n=1000)
plot(dat)
# in the package tseries, the arma() function will fit an arma model for a specific p and q.
mod <- arma(dat)
summary(mod)
# because we are assuming normality, we can calculate confidence intervals for the given data.
confint(mod)
# the estimates and confidence intervals for these parameters represent correlation structures for the time series data, and the confidence interval calculation is the same as multiple linear regression!
# let's see what happens when we fit an ARMA(1,2) model
mod_2 <- arma(dat, order=c(1,2))
summary(mod_2)
anova(mod, mod_2)
airpassengers
Airpassengers
AirPassengers
AirPassengers
plot(AirPassengers)
plot(AirPassengers)
adf.test(AirPassengers)
adf.test(AirPassengers)
# small p value means the test indicates evidence that the data is stationary
# lets look and see if the data fit an AR1 model
pacf(AirPassengers)
mod_1 <- arma(AirPassengers, order = c(1,0))
mod_1 <- arma(AirPassengers, order = c(1,0))
summary(mod_1)
mod_1 <- arma(AirPassengers, order = c(1,0))
summary(mod_1)
mod_2 <- arma(AirPassengers, order = c(1,1))
mod_1 <- arma(AirPassengers, order = c(1,0))
summary(mod_1)
mod_2 <- arma(AirPassengers, order = c(1,1))
summary(mod_2)
mod_1 <- arma(AirPassengers, order = c(1,0))
summary(mod_1)
mod_2 <- arma(AirPassengers, order = c(1,1))
summary(mod_2)
mod_3 <- arma(AirPassengers, order = c(1,2))
mod_1 <- arma(AirPassengers, order = c(1,0))
summary(mod_1)
mod_2 <- arma(AirPassengers, order = c(1,1))
summary(mod_2)
mod_3 <- arma(AirPassengers, order = c(1,2))
summary(mod_3)
mod_1 <- arma(AirPassengers, order = c(1,0))
summary(mod_1)
mod_2 <- arma(AirPassengers, order = c(1,1))
summary(mod_2)
#if we are concerned about nonstationarity, we can try ARIMA(I stands for integration), which is a modeling structure for non stationary time series
mod_arima <- arima(AirPassengers, order = c(1,1,1)
mod_1 <- arma(AirPassengers, order = c(1,0))
summary(mod_1)
mod_2 <- arma(AirPassengers, order = c(1,1))
summary(mod_2)
#if we are concerned about nonstationarity, we can try ARIMA(I stands for integration), which is a modeling structure for non stationary time series
mod_arima <- arima(AirPassengers, order = c(1,1,1))
mod_1 <- arma(AirPassengers, order = c(1,0))
summary(mod_1)
mod_2 <- arma(AirPassengers, order = c(1,1))
summary(mod_2)
#if we are concerned about nonstationarity, we can try ARIMA(I stands for integration), which is a modeling structure for non stationary time series
mod_arima <- arima(AirPassengers, order = c(1,1,1))
summary(mod_arima)
mod_1 <- arma(AirPassengers, order = c(1,0))
#summary(mod_1)
mod_2 <- arma(AirPassengers, order = c(1,1))
#summary(mod_2)
#if we are concerned about nonstationarity, we can try ARIMA(I stands for integration), which is a modeling structure for non stationary time series
mod_arima <- arima(AirPassengers, order = c(1,1,1))
summary(mod_arima)
mod_1 <- arma(AirPassengers, order = c(1,0))
#summary(mod_1)
mod_2 <- arma(AirPassengers, order = c(1,1))
#summary(mod_2)
#if we are concerned about nonstationarity, we can try ARIMA(I stands for integration), which is a modeling structure for non stationary time series
mod_arima <- arima(AirPassengers, order = c(1,1,1))
summary(mod_arima)
coef(mod_arima)
vcov(mod_arima)
P_D <- 0.02
P_PD <- 0.99
P_NDc <- 0.95
P_P <- P_PD * P_D + (1 - P_NDc) * (1 - P_D)
P_D <- 0.02
P_PD <- 0.99
P_NDc <- 0.95
P_P <- P_PD * P_D + (1 - P_NDc) * (1 - P_D)
P_PD
P_D <- 0.02
P_PD <- 0.99
P_NDc <- 0.95
P_P <- P_PD * P_D + (1 - P_NDc) * (1 - P_D)
P_PD * P_D / P_P
library(shiny)
library(ggplot2)
# UI
ui <- fluidPage(
titlePanel("b-Binomial Prior vs Posterior"),
sidebarLayout(
sidebarPanel(
h3("Prior Parameters"),
numericInput("a", "a", value = 2, min = 0.1, step = 0.1),
numericInput("b", "b", value = 2, min = 0.1, step = 0.1),
hr(),
h3("Observed Data"),
numericInput("n", "Number of Trials (n)", value = 10, min = 1, step = 1),
numericInput("k", "Number of Successes (x)", value = 5, min = 0, step = 1),
hr(),
actionButton("update", "Update")
),
mainPanel(
plotOutput("distPlot")
)
)
)
# Server
server <- function(input, output) {
reactive_values <- reactiveValues()
observeEvent(input$update, {
# Capture inputs
a_prior <- input$a
b_prior <- input$b
n <- input$n
k <- input$k
# Posterior parameters
a_post <- a_prior + k
b_post <- b_prior + n - k
# Data for visualization
x <- seq(0, 1, length.out = 500)
prior <- dbeta(x, a_prior, b_prior)
posterior <- dbeta(x, a_post, b_post)
reactive_values$data <- data.frame(
x = c(x, x),
y = c(prior, posterior),
Distribution = rep(c("Prior", "Posterior"), each = length(x))
)
})
output$distPlot <- renderPlot({
req(reactive_values$data)
ggplot(reactive_values$data, aes(x = x, y = y, color = Distribution)) +
geom_line(size = 1.2) +
labs(
title = "Prior vs Posterior Distribution",
x = "Probability of Success (θ)",
y = "Density"
) +
theme_minimal() +
theme(legend.title = element_blank())
})
output$posteriorParams <- renderText({
req(reactive_values$posteriorParams)
reactive_values$posteriorParams
})
}
# Run the app
shinyApp(ui = ui, server = server)
library(shiny)
library(ggplot2)
# UI
ui <- fluidPage(
titlePanel("b-Binomial Prior vs Posterior"),
sidebarLayout(
sidebarPanel(
h3("Prior Parameters"),
numericInput("a", "a", value = 2, min = 0.1, step = 0.1),
numericInput("b", "b", value = 2, min = 0.1, step = 0.1),
hr(),
h3("Observed Data"),
numericInput("n", "Number of Trials (n)", value = 10, min = 1, step = 1),
numericInput("k", "Number of Successes (x)", value = 5, min = 0, step = 1),
hr(),
actionButton("update", "Update")
),
mainPanel(
plotOutput("distPlot")
)
)
)
# Server
server <- function(input, output) {
reactive_values <- reactiveValues()
observeEvent(input$update, {
# Capture inputs
a_prior <- input$a
b_prior <- input$b
n <- input$n
k <- input$k
# Posterior parameters
a_post <- a_prior + k
b_post <- b_prior + n - k
# Data for visualization
x <- seq(0, 1, length.out = 500)
prior <- dbeta(x, a_prior, b_prior)
posterior <- dbeta(x, a_post, b_post)
reactive_values$data <- data.frame(
x = c(x, x),
y = c(prior, posterior),
Distribution = rep(c("Prior", "Posterior"), each = length(x))
)
})
output$distPlot <- renderPlot({
req(reactive_values$data)
ggplot(reactive_values$data, aes(x = x, y = y, color = Distribution)) +
geom_line(size = 1.2) +
labs(
title = "Prior vs Posterior Distribution",
x = "Probability of Success (θ)",
y = "Density"
) +
theme_minimal() +
theme(legend.title = element_blank())
})
output$posteriorParams <- renderText({
req(reactive_values$posteriorParams)
reactive_values$posteriorParams
})
}
# Run the app
shinyApp(ui = ui, server = server)
library(tidyverse)
library(MASS)
fifa <- read.csv('FIFA22_official_data.csv')
head(fifa)
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness) %>%
# ---- Convert Value strings ("€100M", "€80K") to numeric ----
mutate(
Value = gsub("€", "", Value),
Value = case_when(
grepl("M", Value) ~ as.numeric(gsub("M", "", Value)) * 1e6,
grepl("K", Value) ~ as.numeric(gsub("K", "", Value)) * 1e3,
TRUE ~ as.numeric(Value)
),
Height = as.numeric(gsub("cm", "", Height)),
Weight = as.numeric(gsub("kg", "", Weight))
) %>%
# ---- Remove problematic rows ----
filter(is.finite(Value), Value > 0) %>%
na.omit()
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness)
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness)
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness)
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness)
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness) %>%
# ---- Convert Value strings ("€100M", "€80K") to numeric ----
mutate(
Value = gsub("€", "", Value),
Value = case_when(
grepl("M", Value) ~ as.numeric(gsub("M", "", Value)) * 1e6,
grepl("K", Value) ~ as.numeric(gsub("K", "", Value)) * 1e3,
TRUE ~ as.numeric(Value)
),
Height = as.numeric(gsub("cm", "", Height)),
Weight = as.numeric(gsub("kg", "", Weight))
) %>%
# ---- Remove problematic rows ----
filter(is.finite(Value), Value > 0) %>%
na.omit()
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness) %>%
# ---- Convert Value strings ("€100M", "€80K") to numeric ----
mutate(
Value = gsub("€", "", Value),
Value = case_when(
grepl("M", Value) ~ as.numeric(gsub("M", "", Value)) * 1e6,
grepl("K", Value) ~ as.numeric(gsub("K", "", Value)) * 1e3,
TRUE ~ as.numeric(Value)
),
Height = as.numeric(gsub("cm", "", Height)),
Weight = as.numeric(gsub("kg", "", Weight))
) %>%
# ---- Remove problematic rows ----
filter(is.finite(Value), Value > 0) %>%
na.omit()
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness) %>%
# ---- Convert Value strings ("€100M", "€80K") to numeric ----
mutate(
Value = gsub("€", "", Value),
Value = case_when(
grepl("M", Value) ~ as.numeric(gsub("M", "", Value)) * 1e6,
grepl("K", Value) ~ as.numeric(gsub("K", "", Value)) * 1e3,
TRUE ~ as.numeric(Value)
),
Height = as.numeric(gsub("cm", "", Height)),
Weight = as.numeric(gsub("kg", "", Weight))
) %>%
# ---- Remove problematic rows ----
filter(is.finite(Value), Value > 0) %>%
na.omit()
library(tidyverse)
library(MASS)
fifa <- read.csv('FIFA22_official_data.csv')
head(fifa)
names.fifa
library(tidyverse)
library(MASS)
fifa <- read.csv('FIFA22_official_data.csv')
head(fifa)
names(fifa)
setdiff(
c("Value", "Age", "Overall", "Preferred.Foot", "Skill.Moves", "Height", "Weight",
"Crossing", "Finishing", "HeadingAccuracy", "ShortPassing", "Volleys",
"Dribbling", "Curve", "FKAccuracy", "LongPassing", "BallControl",
"Acceleration", "SprintSpeed", "Agility", "Reactions", "Balance",
"ShotPower", "Jumping", "Stamina", "Strength", "LongShots", "Aggression",
"Interceptions", "Positioning", "Vision", "Penalties", "Composure",
"StandingTackle", "SlidingTackle", "DefensiveAwareness"),
names(fifa)
)
str(fifa$Value)
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness) %>%
# ---- Convert Value strings ("€100M", "€80K") to numeric ----
mutate(
Value = gsub("€", "", Value),
Value = case_when(
grepl("M", Value) ~ as.numeric(gsub("M", "", Value)) * 1e6,
grepl("K", Value) ~ as.numeric(gsub("K", "", Value)) * 1e3,
TRUE ~ as.numeric(Value)
),
Height = as.numeric(gsub("cm", "", Height)),
Weight = as.numeric(gsub("kg", "", Weight))
) %>%
# ---- Remove problematic rows ----
filter(is.finite(Value), Value > 0) %>%
na.omit()
library(tidyverse)
fifa <- read.csv('FIFA22_official_data.csv')
head(fifa)
names(fifa)
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness) %>%
# ---- Convert Value strings ("€100M", "€80K") to numeric ----
mutate(
Value = gsub("€", "", Value),
Value = case_when(
grepl("M", Value) ~ as.numeric(gsub("M", "", Value)) * 1e6,
grepl("K", Value) ~ as.numeric(gsub("K", "", Value)) * 1e3,
TRUE ~ as.numeric(Value)
),
Height = as.numeric(gsub("cm", "", Height)),
Weight = as.numeric(gsub("kg", "", Weight))
) %>%
# ---- Remove problematic rows ----
filter(is.finite(Value), Value > 0) %>%
na.omit()
library(tidyverse)
fifa <- read.csv('FIFA22_official_data.csv')
head(fifa)
names(fifa)
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness) %>%
# ---- Convert Value strings ("€100M", "€80K") to numeric ----
mutate(
Value = gsub("€", "", Value),
Value = case_when(
grepl("M", Value) ~ as.numeric(gsub("M", "", Value)) * 1e6,
grepl("K", Value) ~ as.numeric(gsub("K", "", Value)) * 1e3,
TRUE ~ as.numeric(Value)
),
Height = as.numeric(gsub("cm", "", Height)),
Weight = as.numeric(gsub("kg", "", Weight))
) %>%
# ---- Remove problematic rows ----
filter(is.finite(Value), Value > 0) %>%
na.omit()
mod_initial <- lm(Value ~ ., fifa_clean)
summary(mod_initial)
plot(mod_initial,1)
plot(mod_initial,2)
library(MASS)
bc <- boxcox(mod_initial)
lambda <- bc$x[which.max(bc$y)]
lambda
# log transformation
fifa_clean <- fifa_clean %>%
mutate(Value_bc = log(Value))
mod_bc <- lm(Value_bc ~ ., data = fifa_clean %>% select(-Value))
mod_bc <- lm(Value_bc ~ ., data = fifa_clean %>% select(-Value))
# log transformation
fifa_clean <- fifa_clean %>%
select(-Value)
# log transformation
fifa_clean <- fifa_clean %>%
select(-Value) %>%
mutate(Value_bc = log(Value))
# log transformation
fifa_clean <- fifa_clean %>%
select(-Value) %>%
mutate(Value_bc = log(Value))
# log transformation
fifa_clean <- fifa_clean %>%
mutate(Value_bc = log(Value))
mod_bc <- lm(Value_bc ~ ., data = fifa_clean %>% select(-Value))
# need to do a select(-value before importing mass bc it overrides select)
fifa_clean <- fifa_clean %>%
select(-Value)
library(tidyverse)
fifa <- read.csv('FIFA22_official_data.csv')
head(fifa)
names(fifa)
# --- CLEAN DATA ---
fifa_clean <- fifa %>%
select(Value, Age, Overall, Preferred.Foot, Skill.Moves, Height, Weight,
Crossing, Finishing, HeadingAccuracy, ShortPassing, Volleys,
Dribbling, Curve, FKAccuracy, LongPassing, BallControl,
Acceleration, SprintSpeed, Agility, Reactions, Balance,
ShotPower, Jumping, Stamina, Strength, LongShots, Aggression,
Interceptions, Positioning, Vision, Penalties, Composure,
StandingTackle, SlidingTackle, DefensiveAwareness) %>%
# ---- Convert Value strings ("€100M", "€80K") to numeric ----
mutate(
Value = gsub("€", "", Value),
Value = case_when(
grepl("M", Value) ~ as.numeric(gsub("M", "", Value)) * 1e6,
grepl("K", Value) ~ as.numeric(gsub("K", "", Value)) * 1e3,
TRUE ~ as.numeric(Value)
),
Height = as.numeric(gsub("cm", "", Height)),
Weight = as.numeric(gsub("kg", "", Weight))
) %>%
# ---- Remove problematic rows ----
filter(is.finite(Value), Value > 0) %>%
na.omit()
